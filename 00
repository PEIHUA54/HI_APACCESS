現在問題是data資料若同一分鐘取授權碼會一樣
{
  "SysID": "HI_POS",
  "Data": "3750", =>> "Data": "375020251205085414"  
  "CodeLength": 6
}
改成資料加上年月日時分秒
這樣取道的授權碼才不會一樣
 public string GetCode(string requestJson)
 {
     var response = new MGetCode.GetCodeResponse();

     try
     {
         var request = JsonConvert.DeserializeObject<MGetCode.GetCodeRequest>(requestJson);

         if (request == null)
         {
             response = new MGetCode.GetCodeResponse
             {
                 Result_code = Common.Codes.PARAMETER_ERROR,
                 Msg = "請求參數格式錯誤"
             };
             return JsonConvert.SerializeObject(response);
         }

         FGetCode func = new FGetCode();
         response = func.Execute(request.SysID, request.Data, request.CodeLength);
     }
     catch (Exception ex)
     {
         response = new MGetCode.GetCodeResponse
         {
             Result_code = Common.Codes.SYSTEM_ERROR,
             Msg = "系統錯誤：" + ex.Message
         };
     }

     return JsonConvert.SerializeObject(response);
 }
   internal class FGetCode
   {
       // 產授權碼
       public MGetCode.GetCodeResponse Execute(string sysID, string data, int codeLength)
       {
           var response = new MGetCode.GetCodeResponse();

           try
           {
               // 參數驗證
               if (string.IsNullOrWhiteSpace(sysID))
               {
                   response.Result_code = Common.Codes.PARAMETER_ERROR;
                   response.Msg = "系統ID不可為空";
                   return response;
               }

               if (string.IsNullOrWhiteSpace(data))
               {
                   response.Result_code = Common.Codes.PARAMETER_ERROR;
                   response.Msg = "資料不可為空";
                   return response;
               }

               if (codeLength <= 0)
               {
                   response.Result_code = Common.Codes.PARAMETER_ERROR;
                   response.Msg = "授權碼長度必須大於0";
                   return response;
               }

               // 產生授權碼
               string code = GetCode(sysID, data, codeLength);

               response.Result_code = Common.Codes.SUCCESS;
               response.Msg = "成功";
               response.Code = code; 
           }
           catch (Exception ex)
           {
               response.Result_code = Common.Codes.SYSTEM_ERROR;
               response.Msg = "產生授權碼失敗：" + ex.Message;
           }

           return response;
       }

       // 計算授權碼
       private string GetCode(string sysId, string data, int codeLength)
       {
           DateTime tryTime = DateTime.Now;

           // 時間精確到分鐘,秒數設為0
           tryTime = new DateTime(tryTime.Year, tryTime.Month, tryTime.Day,
                  tryTime.Hour, tryTime.Minute, 0);
           string timeStr = tryTime.ToString("yyyy-MM-dd HH:mm:ss");

           // 組合原始字串: 系統ID + 資料 + 時間
           string rawString = sysId + data + timeStr;

           byte[] inputBytes = Encoding.UTF8.GetBytes(rawString);

           // SHA256 雜湊處理
           using (SHA256 sha256 = SHA256.Create())
           {
               byte[] hashBytes = sha256.ComputeHash(inputBytes);
               StringBuilder hex = new StringBuilder();
               foreach (byte b in hashBytes)
               {
                   hex.AppendFormat("{0:X2}", b);
               }

               // 取前N碼作為授權碼
               string fullHash = hex.ToString();
               if (codeLength > fullHash.Length)
                   codeLength = fullHash.Length;

               return fullHash.Substring(0, codeLength).ToUpper();
           }
       }
   }
