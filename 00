我找到錯誤了。在 `ExportUserList` 這一行,問題出在 JavaScript 字串中包含了 Razor 語法,但沒有正確處理。

看這段程式碼:

```javascript
// 匯出帳號清單
$('#btnExportUsers').click(function () {
    var downloadUrl = '@Url.Action("ExportUserList", "AP")';
```

錯誤訊息 “missing ) after argument list” 指的是在這個位置,Razor 產生的 URL 可能包含特殊字元導致 JavaScript 語法錯誤。

**解決方法:**

將 Razor 語法改用 `Html.Raw` 包裝,或確保字串正確編碼:

```javascript
// 匯出帳號清單
$('#btnExportUsers').click(function () {
    var downloadUrl = @Html.Raw(Json.Encode(Url.Action("ExportUserList", "AP")));
    
    var iframe = document.createElement('iframe');
    iframe.style.display = 'none';
    iframe.src = downloadUrl;
    document.body.appendChild(iframe);

    // 延遲顯示授權碼 Modal
    setTimeout(function() {
        checkAndShowAuthCode();
    }, 1000);
});
```

或者更簡單的方式,直接在 HTML 中定義:

在 `@section Scripts` 之前加入:

```html
<script>
    var exportUserListUrl = '@Url.Action("ExportUserList", "AP")';
    var getAuthCodeInfoUrl = '@Url.Action("GetAuthCodeInfo", "AP")';
    var getExportRecordsUrl = '@Url.Action("GetExportRecords", "AP")';
</script>
```

然後在 Scripts section 中使用這些變數:

```javascript
$('#btnExportUsers').click(function () {
    var iframe = document.createElement('iframe');
    iframe.style.display = 'none';
    iframe.src = exportUserListUrl;
    document.body.appendChild(iframe);

    setTimeout(function() {
        checkAndShowAuthCode();
    }, 1000);
});

function checkAndShowAuthCode() {
    $.ajax({
        url: getAuthCodeInfoUrl,
        // ... 其他設定
    });
}

function loadExportRecords() {
    $.ajax({
        url: getExportRecordsUrl,
        // ... 其他設定
    });
}
```

這樣可以避免 Razor 語法在 JavaScript 字串中產生的潛在問題。​​​​​​​​​​​​​​​​