我看到你的錯誤訊息了 👀
問題出在：
	•	你用的 連線字串 是 ConnDB_TFS_HI_AUTOS（資料庫 [HI_AUTOS]）
	•	但查詢裡 VW_M1EMP_MAST 這個 View 實際存在於 [HI_TMMAIN]

所以 SQL Server 會報錯 → 無效的物件名稱。

⸻

🔧 解決方法

這裡有三個做法，你要依環境決定：

⸻

✅ 方法 1：在 SQL 裡加 DB 前綴

如果同一個帳號能存取 [HI_TMMAIN]，可以直接改查詢：

string checkEmpSql = "SELECT EMP_NAME FROM [HI_TMMAIN].dbo.VW_M1EMP_MAST WHERE EMP_NO=@EMP_NO";

這樣即使你用 [HI_AUTOS] 連線，也能跨 DB 查詢 [HI_TMMAIN]。

⸻

✅ 方法 2：用兩個連線字串

如果權限限制，HI_AUTOS 的帳號不能查 HI_TMMAIN，那就要分開連線：

using (var conEmp = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnDB_TFS_HI_TMMAIN"].ConnectionString))
{
    conEmp.Open();
    using (var cmd = new SqlCommand("SELECT EMP_NAME FROM VW_M1EMP_MAST WHERE EMP_NO=@EMP_NO", conEmp))
    {
        cmd.Parameters.AddWithValue("@EMP_NO", row.EmpNo);
        empName = cmd.ExecuteScalar() as string;
    }
}

然後 AP_USER 還是照舊寫進 HI_AUTOS。

⸻

✅ 方法 3：在 DB 裡建 Linked Server / Synonym

如果不想改程式，可以請 DBA 幫忙：
	•	在 [HI_AUTOS] 建一個 Synonym 指到 [HI_TMMAIN].dbo.VW_M1EMP_MAST

CREATE SYNONYM VW_M1EMP_MAST FOR [HI_TMMAIN].dbo.VW_M1EMP_MAST;

這樣程式不用改 SQL，HI_AUTOS 也能直接查 VW_M1EMP_MAST。

⸻

🔑 建議

就程式層面來說，方法 1（加 DB 前綴）最快最穩，只要帳號有跨 DB 權限。
如果你不確定權限，就用 方法 2（兩個連線字串）。

⸻

要不要我幫你改成 方法 2 的完整程式碼（一個連線查人、一個連線存檔），這樣就不怕跨 DB 沒權限？