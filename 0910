取得員工主檔
需要增加兩個需求參數
1.Type查詢類型// 1:全部名單(在職EnterDate+離職EndDate)  2:在職名單(沒有EndDate的人)  3:指定名單 (依據EmpNoList取指定的員工)
2.EmpNoList指定名單 //string[]  (員編 ex: ["3B750","3A717"] ) 只有類型為3才必需要有

 // 取得員工主檔
 public string GetEmpMast(string requestJson)
 {
     var response = new GetEmpMastModel.GetEmpMastResponse();

     try
     {
         var request = JsonConvert.DeserializeObject<GetEmpMastModel.GetEmpMastRequest>(requestJson);
         FGetEmpMast func = new FGetEmpMast();
         response = func.Execute(request.Environment);
     }
     catch (Exception ex)
     {
         response = new GetEmpMastModel.GetEmpMastResponse
         {
             Result_code = Common.Codes.SYSTEM_ERROR,
             Msg = "系統錯誤：" + ex.Message
         };
     }

     return JsonConvert.SerializeObject(response);
 }

  internal class GetEmpMastModel  
  {
      // 請求參數 
      internal class GetEmpMastRequest
      {
          [JsonProperty]
          [DisplayName("查詢類型")] // 1:全部名單(在職+離職)  2:在職名單  3:指定名單
          internal string Type { get; set; }

          [JsonProperty]
          [DisplayName("指定名單")]  //string[]  (員編 ex: ["3B750","3A717"] )
          internal string EmpNoList { get; set; }

          [JsonProperty]
          [DisplayName("環境")]
          internal string Environment { get; set; }
      }

      // 回應結果
      internal class GetEmpMastResponse
      {
          [JsonProperty]
          [DisplayName("回覆代碼")]
          internal string Result_code { get; set; }

          [JsonProperty]
          [DisplayName("訊息")]
          internal string Msg { get; set; }

          [JsonProperty("Result")]
          [DisplayName("回覆結果")]
          public List<ResultData> Result { get; set; }
      }

      public class ResultData
      {
          [JsonProperty]
          public string EmpNo { get; set; }

          [JsonProperty]
          public string EmpName { get; set; }

          [JsonProperty]
          public string OrganNo { get; set; }

          [JsonProperty]
          public string OrganName { get; set; }

          [JsonProperty]
          public string PostNo { get; set; }

          [JsonProperty]
          public string PostName { get; set; }

          [JsonProperty]
          public string EnterDate { get; set; }

          [JsonProperty]
          public string EndDate { get; set; }
      }
  }

    internal class FGetEmpMast
    {
        internal GetEmpMastModel.GetEmpMastResponse Execute(string environment)
        {
            var response = new GetEmpMastModel.GetEmpMastResponse();

            try
            {
                // 1. 環境檢查
                if (environment != "TEST" && environment != "PROD" && environment != "DEV")
                {
                    response.Result_code = Common.Codes.ENV_ERROR;
                    response.Msg = "環境錯誤，只接受 TEST 或 PROD";
                    return response;
                }

                var resultList = new List<GetEmpMastModel.ResultData>();

                using (SqlConnection conn = new SqlConnection(FCommon.BuildConnectionString(environment)))
                {
                    conn.Open();

                    string sql = @"
  SELECT [EMP_NO] as EmpNo
        ,[EMP_NAME] as EmpName
        ,[ORGAN_NO] as OrganNo
        ,[ORGAN_CAP] as OrganName
        ,[POST_NO] as PostNo
        ,[POST_NAME] as PostName
        ,[ENTER_DT] as EnterDate
        ,[END_DT]  as EndDate
  FROM [HI-AUTOS].[dbo].[M1EMP_MAST]
";
                    using (SqlCommand cmd = new SqlCommand(sql, conn))
                    {
                        using (var reader = cmd.ExecuteReader())
                        {
                            while (reader.Read())
                            {
                                resultList.Add(new GetEmpMastModel.ResultData
                                {
                                    EmpNo = reader["EmpNo"].ToString(),
                                    EmpName = reader["EmpName"].ToString(),
                                    OrganNo = reader["OrganNo"].ToString(),
                                    OrganName = reader["OrganName"].ToString(),
                                    PostNo = reader["PostNo"].ToString(),
                                    PostName = reader["PostName"].ToString(),
                                    EnterDate = reader["EnterDate"].ToString(),
                                    EndDate = reader["EndDate"].ToString(),
                                });
                            }
                        }
                    }
                }

                if (resultList.Count == 0)
                {
                    response.Result_code = Common.Codes.NO_DATA;
                    response.Msg = "查無資料";
                }
                else
                {
                    response.Result_code = Common.Codes.SUCCESS;
                    response.Msg = "成功";
                    response.Result = resultList;
                }
            }
            catch (Exception ex)
            {
                response.Result_code = Common.Codes.SYSTEM_ERROR;
                response.Msg = "系統錯誤：" + ex.Message;
            }

            return response;
        }

    }
