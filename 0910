ç•¶ç„¶å¯ä»¥ï¼ç”¨ Razor èªæ³•åœ¨ä¼ºæœå™¨ç«¯ç›´æ¥ç”Ÿæˆ Table æ˜¯æ›´ç°¡å–®ç›´æ¥çš„åšæ³•ã€‚è®“æˆ‘æ”¹å¯«æˆä½ åƒè€ƒçš„é‚£ç¨®é¢¨æ ¼ï¼š

## ä¿®æ”¹ SYSController.cs

```csharp
// ç”³è«‹ç³»çµ±
public ActionResult SYS_APPLY()
{
    try
    {
        var systems = F_SYS.GetMaintainableSystems(Emp_NO);
        return View(systems);
    }
    catch (Exception ex)
    {
        // ç™¼ç”ŸéŒ¯èª¤æ™‚å›å‚³ç©ºæ¸…å–®
        return View(new List<M_SYS>());
    }
}
```

## ä¿®æ”¹ SYS_APPLY.cshtml

```html
@model IEnumerable<HI_APACCESS.Models.M_SYS.M_SYS>

@using HI_APACCESS.Service;

@{
    ViewBag.Title = "ç³»çµ±ç”³è«‹ç®¡ç†";
    HI_APACCESS.Controllers.HI_APACCESSBaseController controller = ViewContext.Controller as HI_APACCESS.Controllers.HI_APACCESSBaseController;
    var emp_APG_NO = controller.APG_NO;
    var emp_no = controller.Emp_NO;
    var ctrlName = ViewContext.RouteData.Values["controller"].ToString();
}

<link rel="stylesheet" href="@Url.Version("Form.css","CSS")" />
<link rel="stylesheet" href="@Url.Version("FieldNameSwitch.css","CSS")" />

<style>
    .tb-workonroad a {
        text-decoration: none;
        color: #ffffff;
        display: block;
    }

    .tb-workonroad thead tr {
        background-color: #E6CCB2;
    }

    #systemTable {
        width: 100%;
    }

        #systemTable th, #systemTable td {
            text-align: center;
            vertical-align: middle;
        }
</style>

<section class="page-title">
    <div class="triangle"></div>
    <div class="title-text">ç³»çµ±ç”³è«‹ç®¡ç†</div>
</section>

<div>
    <div>
        <div style="overflow-y: auto; height: 835px; overflow-x: auto;">
            <section class="form-data" id="table-border">
                <table id="systemTable" class="table table-bordered">
                    <thead style="position:sticky; top:-0.1px; z-index:2;">
                        <tr>
                            <th style="width:100px;">
                                <button type="button" class="btn btn-green" id="btnAdd">
                                    <i class="fas fa-plus"></i> æ–°å¢
                                </button>
                            </th>
                            <th style="width:150px;">ç³»çµ±ID</th>
                            <th style="width:200px;">ç³»çµ±åç¨±</th>
                            <th style="width:100px;">å»ºç«‹äººå“¡</th>
                            <th style="width:150px;">å»ºç«‹æ—¥æœŸ</th>
                            <th style="width:100px;">ä¿®æ”¹äººå“¡</th>
                            <th style="width:150px;">ä¿®æ”¹æ—¥æœŸ</th>
                        </tr>
                    </thead>

                    <tbody>
                        @if (Model != null && Model.Any())
                        {
                            foreach (var item in Model)
                            {
                                <tr>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-warning btn-edit" 
                                                data-sysid="@item.SYS_ID" 
                                                data-sysname="@item.SYS_NAME">
                                            <i class="fas fa-edit"></i> ä¿®æ”¹
                                        </button>
                                    </td>
                                    <td>@item.SYS_ID</td>
                                    <td>@item.SYS_NAME</td>
                                    <td>@item.CREATOR</td>
                                    <td>@(item.CREATE_TIME?.ToString("yyyy-MM-dd HH:mm:ss"))</td>
                                    <td>@item.EDITOR</td>
                                    <td>@(item.EDIT_TIME?.ToString("yyyy-MM-dd HH:mm:ss"))</td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="7" style="text-align:center; font-weight:600;">æŸ¥ç„¡è³‡æ–™</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </section>
        </div>
    </div>
</div>

<!-- æ–°å¢/ä¿®æ”¹ Modal -->
<div class="modal fade" id="systemModal" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">æ–°å¢ç³»çµ±</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="systemForm">
                    <div class="form-group">
                        <label for="sysId">ç³»çµ±ID <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="sysId" name="SYS_ID" required maxlength="50">
                        <small class="form-text text-muted">ç³»çµ±IDä¸å¯è¶…é50å­—å…ƒ</small>
                    </div>
                    <div class="form-group">
                        <label for="sysName">ç³»çµ±åç¨± <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="sysName" name="SYS_NAME" required maxlength="100">
                        <small class="form-text text-muted">ç³»çµ±åç¨±ä¸å¯è¶…é100å­—å…ƒ</small>
                    </div>
                    <input type="hidden" id="actionType" name="Action" value="Add">
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" id="btnSave">å„²å­˜</button>
            </div>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        $(document).ready(function () {
            initPage();
        });

        function initPage() {
            // æ–°å¢æŒ‰éˆ•äº‹ä»¶
            $('#btnAdd').off('click').on('click', function () {
                resetForm();
                $('#modalTitle').text('æ–°å¢ç³»çµ±');
                $('#sysId').prop('readonly', false);
                $('#actionType').val('Add');
                $('#systemModal').modal('show');
            });

            // ä¿®æ”¹æŒ‰éˆ•äº‹ä»¶
            $('.btn-edit').off('click').on('click', function () {
                var sysId = $(this).data('sysid');
                var sysName = $(this).data('sysname');
                editSystem(sysId, sysName);
            });

            // å„²å­˜æŒ‰éˆ•äº‹ä»¶
            $('#btnSave').off('click').on('click', function () {
                saveSystem();
            });
        }

        // å„²å­˜ç³»çµ±
        function saveSystem() {
            var formData = {
                SYS_ID: $('#sysId').val().trim(),
                SYS_NAME: $('#sysName').val().trim(),
                Action: $('#actionType').val()
            };

            if (!formData.SYS_ID || !formData.SYS_NAME) {
                alert('ç³»çµ±IDå’Œç³»çµ±åç¨±ç‚ºå¿…å¡«');
                return;
            }

            $.ajax({
                url: '@Url.Action("ApplySystem", "SYS")',
                type: 'POST',
                data: formData,
                dataType: 'json',
                success: function (response) {
                    if (response.success) {
                        alert(response.message);
                        $('#systemModal').modal('hide');
                        // é‡æ–°è¼‰å…¥é é¢ä»¥é¡¯ç¤ºæ›´æ–°å¾Œçš„è³‡æ–™
                        location.reload();
                    } else {
                        alert(response.message);
                    }
                },
                error: function () {
                    alert('å„²å­˜æ™‚ç™¼ç”ŸéŒ¯èª¤');
                }
            });
        }

        // ç·¨è¼¯ç³»çµ±
        function editSystem(sysId, sysName) {
            resetForm();
            $('#modalTitle').text('ä¿®æ”¹ç³»çµ±åç¨±');
            $('#sysId').val(sysId).prop('readonly', true);
            $('#sysName').val(sysName);
            $('#actionType').val('Edit');
            $('#systemModal').modal('show');
        }

        // é‡ç½®è¡¨å–®
        function resetForm() {
            $('#systemForm')[0].reset();
            $('#sysId').prop('readonly', false);
        }
    </script>
}
```

## ä¸»è¦æ”¹è®Š

### **1. Controller æ”¹æˆå›å‚³ Model**

```csharp
public ActionResult SYS_APPLY()
{
    var systems = F_SYS.GetMaintainableSystems(Emp_NO);
    return View(systems);  // ç›´æ¥æŠŠè³‡æ–™å‚³çµ¦ View
}
```

### **2. View ç”¨ Razor èªæ³•ç”Ÿæˆè¡¨æ ¼**

```html
@if (Model != null && Model.Any())
{
    foreach (var item in Model)
    {
        <tr>
            <td>...</td>
            <td>@item.SYS_ID</td>
            <td>@item.SYS_NAME</td>
            ...
        </tr>
    }
}
```

### **3. JavaScript ç°¡åŒ–**

- ç§»é™¤ `loadSystemData()` å’Œ `renderSystemTable()` å‡½æ•¸
- ç§»é™¤ `formatDateTime()` å‡½æ•¸ï¼ˆæ”¹ç”¨ Razor çš„ `ToString()` æ ¼å¼åŒ–ï¼‰
- åªä¿ç•™å¿…è¦çš„äº‹ä»¶ç¶å®šå’Œ Modal æ“ä½œ

### **4. å„²å­˜æˆåŠŸå¾Œé‡æ–°è¼‰å…¥é é¢**

```javascript
if (response.success) {
    alert(response.message);
    $('#systemModal').modal('hide');
    location.reload();  // é‡æ–°è¼‰å…¥æ•´å€‹é é¢
}
```

## å„ªé»

âœ… **ç¨‹å¼ç¢¼æ›´ç°¡æ½”** - JavaScript å¾ 100+ è¡Œæ¸›å°‘åˆ° 50 è¡Œå·¦å³  
âœ… **ç¬¦åˆ MVC æ¶æ§‹** - è³‡æ–™åœ¨ä¼ºæœå™¨ç«¯è™•ç†ï¼ŒView åªè² è²¬å‘ˆç¾  
âœ… **æ•ˆèƒ½æ›´å¥½** - ç¬¬ä¸€æ¬¡è¼‰å…¥å°±æœ‰å®Œæ•´è³‡æ–™ï¼Œä¸éœ€è¦é¡å¤– AJAX è«‹æ±‚  
âœ… **ç¶­è­·æ›´å®¹æ˜“** - ä¸éœ€è¦åœ¨ JS ä¸­æ‹¼æ¥ HTML  
âœ… **SEO å‹å–„** - è³‡æ–™ç›´æ¥åœ¨ HTML ä¸­ï¼Œæœå°‹å¼•æ“å¯ä»¥ç´¢å¼•

## å¯ä»¥åˆªé™¤çš„ Controller Action

å› ç‚ºä¸å†éœ€è¦ AJAX è¼‰å…¥è³‡æ–™ï¼Œå¯ä»¥åˆªé™¤é€™å€‹ Actionï¼š

```csharp
// âŒ å¯ä»¥åˆªé™¤
[HttpPost]
public JsonResult GetMaintainableSystems()
{
    // ...
}
```

é€™æ¨£å¯«æ˜¯ä¸æ˜¯æ›´ç¬¦åˆä½ çš„ç¿’æ…£ï¼ŸğŸ˜Šâ€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹