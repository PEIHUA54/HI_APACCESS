好 👍 我用你這個 Info_List 當範例，把 功能4 (GetFuncBtn) 和 功能5 (CheckBtnEnabled) 串起來，並逐一解釋你的問題。






🔹 需求整理 (根據你說的規則)
	•	001 群組：新增(上方)、修改(列)、刪除(列)
	•	其他群組：只有新增(上方)
	•	查詢(上方)：所有群組都能用

⸻

🔹 功能4 SQL 的定位

功能4 (GetFuncBtn) 回傳的是 「某群組在某頁面可以用的按鈕清單」。
👉 所以位置 (BtnLocation) 只是標記「這個按鈕要放在工具列(Top) 還是資料列(Row)」。

舉例：
	•	BtnLocation=Top → 出現在頁面工具列上方
	•	BtnLocation=Row → 出現在資料表每一列

⸻

🔹 OnClick 的問題
	1.	onclick 在資料表內就存 函式名稱 (帶參數的模板)。
	•	例如：confirmDelete('{0}')
	•	系統在畫面生成時把 {0} 代換成 item.FILE_NAME 或其他動態值。
	2.	如果新增跟查詢要傳不同參數 → 在 DB 就存不同的 OnClick 定義：
	•	Info_Insert('{0}')
	•	performSearch('{0}', '{1}')
	3.	Action / Controller 不同 → 在 AP_RFUNC 表裡面 直接存 Controller、Action 名稱，畫面上用 Html.BeginForm 就能生成正確的路徑。

⸻

🔹 改版範例 (套用到 Info_List)

Model (ViewModel 包一個清單)

public class InfoListViewModel
{
    public IEnumerable<M_POS_IMG.M_POS_INFO> Data { get; set; }
    public List<GetFuncBtnModel.ResultData> AuthorizedButtons { get; set; }
}


⸻

Controller

[HttpGet]
public ActionResult Info_List(string filetype, string selectedPositem, string Select_key, 
    [Bind] Models.M_POS_IMG.Select Select = Models.M_POS_IMG.Select.nodata, int PageNo = 1)
{
    filetype = "A";
    var queryResult = F_Common.GetPosInfo_ABE<M_POS_IMG.M_POS_INFO>(APG_NO, filetype, selectedPositem);

    var filterResult = queryResult.AsQueryable();
    if (Select != Models.M_POS_IMG.Select.nodata && !string.IsNullOrEmpty(Select_key))
    {
        switch (Select)
        {
            case Models.M_POS_IMG.Select.FILE_NAME:
                filterResult = filterResult.Where(x => x.FILE_NAME.Contains(Select_key));
                break;
            case Models.M_POS_IMG.Select.FILE_FORMAT:
                filterResult = filterResult.Where(x => x.FILE_FORMAT.Contains(Select_key));
                break;
            case Models.M_POS_IMG.Select.CASE_UNIT:
                filterResult = filterResult.Where(x => x.CASE_UNIT.Contains(Select_key));
                break;
        }
    }

    // 🔹 功能4：取出可用按鈕清單
    var btnReq = new GetFuncBtnModel.GetFuncBtnRequest
    {
        SysID = "HI_POSIMG",
        GroupID = APG_NO,
        FuncID = "INFO_LIST",
        Environment = "TEST"
    };
    string json = JsonConvert.SerializeObject(btnReq);
    string raw = new APACCESS().GetFuncBtn(json);
    var btnRes = JsonConvert.DeserializeObject<GetFuncBtnModel.GetFuncBtnResponse>(raw);

    var vm = new InfoListViewModel
    {
        Data = filterResult.ToPagedList(PageNo, 25),
        AuthorizedButtons = btnRes?.Result ?? new List<GetFuncBtnModel.ResultData>()
    };

    ViewBag.posItem = F_POSIMG_INFO.Get_DropDownList_PosItem();
    ViewBag.Select = Select;
    ViewBag.Select_key = Select_key;

    return View(vm);
}


⸻

View (只保留重點)

@model InfoListViewModel
@{
    var emp_APG_NO = (ViewContext.Controller as POSFILE_APPLY.Controllers.POSFILE_APPLYBaseController).APG_NO;
}

<!-- 🔹 Top 工具列 -->
<div class="toolbar">
    @foreach (var btn in Model.AuthorizedButtons.Where(b => b.BtnLocation == "Top"))
    {
        if (!string.IsNullOrEmpty(btn.Controller) && !string.IsNullOrEmpty(btn.Action))
        {
            using (Html.BeginForm(btn.Action, btn.Controller, FormMethod.Get))
            {
                <button type="submit" id="@btn.BtnID" class="btn btn-primary">@btn.BtnName</button>
            }
        }
        else if (!string.IsNullOrEmpty(btn.BtnOnclick))
        {
            <button type="button" id="@btn.BtnID" class="btn btn-secondary"
                    onclick="@btn.BtnOnclick.Replace("{0}", "someValue")">
                @btn.BtnName
            </button>
        }
    }

    <!-- 查詢 → 全部群組共用 -->
    <button type="submit" class="btn btn-warning" onclick="performSearch()">查詢</button>
</div>

<!-- 🔹 資料表 -->
<table class="table">
    <thead>
        <tr>
            <th>操作</th>
            <th>檔案名稱</th>
            <th>檔案格式</th>
            ...
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.Data)
        {
            <tr>
                <td>
                    @foreach (var btn in Model.AuthorizedButtons.Where(b => b.BtnLocation == "Row"))
                    {
                        if (!string.IsNullOrEmpty(btn.Controller) && !string.IsNullOrEmpty(btn.Action))
                        {
                            using (Html.BeginForm(btn.Action, btn.Controller, new { filename = item.FILE_NAME }, FormMethod.Post))
                            {
                                <button type="submit" id="@btn.BtnID" class="btn btn-sm btn-primary">@btn.BtnName</button>
                            }
                        }
                        else if (!string.IsNullOrEmpty(btn.BtnOnclick))
                        {
                            <button type="button" id="@btn.BtnID" class="btn btn-sm btn-danger"
                                    onclick="@btn.BtnOnclick.Replace("{0}", item.FILE_NAME)">
                                @btn.BtnName
                            </button>
                        }
                    }
                </td>
                <td>@item.FILE_NAME</td>
                <td>@item.FILE_FORMAT</td>
            </tr>
        }
    </tbody>
</table>


⸻

🔹 最後回答你的問題
	1.	位置只是用來分類迴圈 → Top (上方工具列)，Row (每一列)。
	2.	OnClick 參數 → 在 DB 設定模板 MyFunc('{0}')，View 代換成實際值。
	3.	不同 Action/Controller → 在 DB 存 Controller/Action，View 用 Html.BeginForm 產生。
	4.	功能5 vs Hi_Btn → Hi_Btn 是簡化版 (單一顆按鈕判斷)，功能4 是清單版 (一頁多顆)。
	•	如果按鈕很少 → 用功能5 + Hi_Btn。
	•	如果按鈕多又要動態長出來 → 用功能4。

⸻

要不要我幫你畫一張 Info_List 頁面對照圖：001 群組跟其他群組各自能看到哪些按鈕，讓你一眼理解差別？