å“¦ï½æˆ‘æ‡‚äº†ï¼Œä½ æ˜¯å• æ”¹ç‰ˆå¾Œçš„ SVS_å“¡å·¥åŸºæœ¬è³‡æ–™ è·Ÿ SVS_å®¢è£½åŒ–å…ƒä»¶ï¼Œè¦æ€éº¼æ”¹æˆå‘¼å« DLL çš„åŠŸèƒ½ 1ï½5ï¼Œå°å§ï¼Ÿ
ï¼ˆä¹‹å‰ä½ ä¸Ÿçš„æ˜¯èˆŠç‰ˆ SVS_å“¡å·¥åŸºæœ¬è³‡æ–™ + SVS_å®¢è£½åŒ–å…ƒä»¶ï¼Œéƒ½è‡ªå·±æ‰“ SQL æŸ¥è³‡æ–™åº«ï¼‰

â¸»

ğŸ”¹æ–°ç‰ˆè¨­è¨ˆé‡é»
	1.	èˆŠç‰ˆå•é¡Œ
	â€¢	SVS_å“¡å·¥åŸºæœ¬è³‡æ–™ï¼šè‡ªå·±æ‰“ SQL å»æŠ“ M1EMP_MAST / AP_USERã€‚
	â€¢	SVS_å®¢è£½åŒ–å…ƒä»¶ï¼šè‡ªå·±æ‰“ SQL å»æª¢æŸ¥ AP_RFUNC / AP_USER_RFUNC_CONFIGã€‚
	â€¢	ç¼ºé»ï¼šç¨‹å¼åˆ†æ•£ã€SQL ä¾è³´å¤ªé‡ã€ä¸åˆ©ç¶­è­·ã€‚
	2.	æ–°ç‰ˆåšæ³•
	â€¢	æ”¹æˆå‘¼å« DLLï¼ˆHI_APACCESS_DLL_FRAMEWORK.APACCESSï¼‰ã€‚
	â€¢	åŠŸèƒ½ 1ï¼šå–ä½¿ç”¨è€…ç¾¤çµ„èˆ‡åç¨± â†’ å–å“¡å·¥åŸºæœ¬è³‡æ–™ã€‚
	â€¢	åŠŸèƒ½ 3ï¼šå–æ¨¹ç‹€æ¸…å–® â†’ å–åŠŸèƒ½æ¸…å–® (Get_Tree)ã€‚
	â€¢	åŠŸèƒ½ 5ï¼šç¢ºèªæ˜¯å¦æœ‰æŒ‰éˆ•æ¬Šé™ â†’ å–æŒ‰éˆ•æ¬Šé™ã€‚
	â€¢	å…¶ä»– SQL å°±å¯ä»¥ç æ‰ã€‚

â¸»

ğŸ”¹æ–°ç‰ˆ SVS_å“¡å·¥åŸºæœ¬è³‡æ–™

ğŸ‘‰ å‘¼å« åŠŸèƒ½ 1 ä»£æ›¿ Get_å“¡å·¥ç·¨è™Ÿ() å’Œ Get_å“¡å·¥åŸºæœ¬è³‡æ–™()ã€‚

using HI_APACCESS_DLL_FRAMEWORK;
using Newtonsoft.Json;
using System;
using POSFILE_APPLY.Models; // ä½ å¯ä»¥åœ¨é€™é‚Šæ”¾ Request/Response Model

namespace POSFILE_APPLY.Service
{
    public class SVS_å“¡å·¥åŸºæœ¬è³‡æ–™
    {
        /// <summary>
        /// å–å¾—å“¡å·¥åŸºæœ¬è³‡æ–™ (é€é DLL åŠŸèƒ½1)
        /// </summary>
        internal static M_AP.GetUserNameAndGroupResponseModel Get_å“¡å·¥åŸºæœ¬è³‡æ–™(string sysId, string userAd, string environment)
        {
            var req = new M_AP.GetUserNameAndGroupRequestModel
            {
                SysID = sysId,
                UserAD = userAd,
                Environment = environment
            };

            string json_input = JsonConvert.SerializeObject(req);
            string response = new APACCESS().GetUserNameAndGroup(json_input);

            var res = JsonConvert.DeserializeObject<M_AP.GetUserNameAndGroupResponseModel>(response);
            return res;
        }

        /// <summary>
        /// åªå–å“¡å·¥ç·¨è™Ÿ (AD â†’ å“¡ç·¨)
        /// </summary>
        internal static string Get_å“¡å·¥ç·¨è™Ÿ(string sysId, string userAd, string environment)
        {
            var empData = Get_å“¡å·¥åŸºæœ¬è³‡æ–™(sysId, userAd, environment);
            return empData?.Result?.UserID; // DLL åŠŸèƒ½1 å·²ç¶“å¹«ä½ è½‰æ›å¥½ AD â†’ å“¡ç·¨
        }
    }
}


â¸»

ğŸ”¹æ–°ç‰ˆ SVS_å®¢è£½åŒ–å…ƒä»¶

ğŸ‘‰ å‘¼å« åŠŸèƒ½ 5 ä»£æ›¿ IfBtnAuth_Positiveã€‚

using HI_APACCESS_DLL_FRAMEWORK;
using Newtonsoft.Json;
using System.Web.Mvc;
using POSFILE_APPLY.Models;

namespace POSFILE_APPLY.Service
{
    public static class SVS_å®¢è£½åŒ–å…ƒä»¶
    {
        /// <summary>
        /// æ–°ç‰ˆ Hi_Btn - ä½¿ç”¨ DLL åŠŸèƒ½5 ç¢ºèªæŒ‰éˆ•æ¬Šé™
        /// </summary>
        public static MvcHtmlString Hi_Btn(this HtmlHelper helper, string sysId, string groupId, string funcId, string buttonId, string buttonText, string buttonType, object htmlAttributes, string environment = "TEST")
        {
            // å‘¼å« DLL åŠŸèƒ½5
            var req = new M_AP.CheckBtnEnabledRequestModel
            {
                SysID = sysId,
                GroupID = groupId,
                FuncID = funcId,
                BtnID = buttonId,
                Environment = environment
            };

            string json_input = JsonConvert.SerializeObject(req);
            string response = new APACCESS().CheckBtnEnabled(json_input);
            var res = JsonConvert.DeserializeObject<M_AP.CheckBtnEnabledResponseModel>(response);

            if (res.Result) // æœ‰æ¬Šé™æ‰ç”¢ç”ŸæŒ‰éˆ•
            {
                TagBuilder tb = new TagBuilder("button");
                tb.SetInnerText(buttonText);
                tb.Attributes.Add("id", buttonId);
                tb.Attributes.Add("type", buttonType);

                if (htmlAttributes != null)
                {
                    var attrs = HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes);
                    tb.MergeAttributes(attrs);
                }

                return MvcHtmlString.Create(tb.ToString());
            }

            return null; // æ²’æ¬Šé™ â†’ ä¸é¡¯ç¤º
        }
    }
}


â¸»

ğŸ”¹æ¸¬è©¦æµç¨‹
	1.	åœ¨ SVS_å“¡å·¥åŸºæœ¬è³‡æ–™ï¼š

var emp = SVS_å“¡å·¥åŸºæœ¬è³‡æ–™.Get_å“¡å·¥åŸºæœ¬è³‡æ–™("HI_POSIMG", "3B750", "TEST");
Console.WriteLine(emp.Result.UserName); // ç‹å°æ˜

âœ… æœƒå›å‚³å“¡å·¥è³‡æ–™ã€‚

	2.	åœ¨ SVS_å®¢è£½åŒ–å…ƒä»¶ï¼š

@Html.Hi_Btn("HI_POSIMG", "001", "POS1001", "BtnInsert", "æ–°å¢", "button", new { @class="btn btn-primary" })

âœ… å¦‚æœç¾¤çµ„ 001 æœ‰ BtnInsert æ¬Šé™ â†’ ç”¢ç”ŸæŒ‰éˆ•ï¼Œå¦å‰‡å›å‚³ nullï¼ˆæŒ‰éˆ•éš±è—ï¼‰ã€‚

â¸»

è¦ä¸è¦æˆ‘å¹«ä½ ç›´æ¥æŠŠ M_AP çš„æ¸¬è©¦ Request/Response Model (åŠŸèƒ½1ã€åŠŸèƒ½5) ä¸€èµ·ç”Ÿå‡ºä¾†ï¼Ÿ
é€™æ¨£ä½  web æ¸¬è©¦ç¨‹å¼å¯ä»¥ç›´æ¥è·‘ã€‚