å¥½ ğŸ‘ æˆ‘å¹«ä½ æŠŠ ä¸ƒå€‹æŒ‰éˆ•ï¼ˆåŠŸèƒ½1â€“7ï¼‰ çš„ç¨‹å¼ç¢¼ä¸€æ¬¡ç”Ÿå®Œæ•´ï¼Œç›´æ¥æ”¾é€² Form1.cs å°±èƒ½ç”¨äº†ã€‚
ç¨‹å¼ç¢¼æœƒä¾ç…§ä½ åŒäº‹çš„ style â€”â€” ä¸æ‹†å‡ºå»ï¼Œç›´æ¥åœ¨æŒ‰éˆ•äº‹ä»¶è£¡é¢åºåˆ—åŒ–ã€å‘¼å« DLLã€é¡¯ç¤ºåˆ° Form2ã€‚

â¸»

ğŸ“Œ Form1.csï¼ˆå®Œæ•´ç¯„ä¾‹ï¼‰

using Newtonsoft.Json;
using System;
using System.Windows.Forms;
using HI_APACCESS_DLL;   // å¼•ç”¨ DLL

namespace HI_APACCESS_DLL_TEST
{
    public partial class Form1 : Form
    {
        private APACCESS ARC = new APACCESS();  // DLL ä¸»é¡åˆ¥

        public Form1()
        {
            InitializeComponent();
        }

        // ===== åŠŸèƒ½1ï¼šGetUserData =====
        private void btnGetUserData_Click(object sender, EventArgs e)
        {
            var input = new Model.GetUserDataRequest
            {
                SysID = txtSysID.Text,
                UserAD = txtUserAD.Text,
                Environment = txtEnv.Text
            };

            string json_input = JsonConvert.SerializeObject(input);
            string json_output = ARC.GetUserNameAndGroup(json_input);
            var output = JsonConvert.DeserializeObject<Model.GetUserDataResponse>(json_output);

            Form2 obj = new Form2();
            obj.TextBoxMsg1 = json_input;
            obj.TextBoxMsg2 = json_output;
            obj.Show();
        }

        // ===== åŠŸèƒ½2ï¼šGetGroupAllUser =====
        private void btnGetGroupAllUser_Click(object sender, EventArgs e)
        {
            var input = new Model.GetGroupAllUserRequest
            {
                SysID = txtSysID.Text,
                GroupID = txtGroupID.Text,
                IsIncludeChildGroups = chkChildGroup.Checked,
                Environment = txtEnv.Text
            };

            string json_input = JsonConvert.SerializeObject(input);
            string json_output = ARC.GetGroupAllUser(json_input);
            var output = JsonConvert.DeserializeObject<Model.GetGroupAllUserResponse>(json_output);

            Form2 obj = new Form2();
            obj.TextBoxMsg1 = json_input;
            obj.TextBoxMsg2 = json_output;
            obj.Show();
        }

        // ===== åŠŸèƒ½3ï¼šGetTree =====
        private void btnGetTree_Click(object sender, EventArgs e)
        {
            var input = new Model.GetTreeRequest
            {
                SysID = txtSysID.Text,
                GroupID = txtGroupID.Text,
                Environment = txtEnv.Text
            };

            string json_input = JsonConvert.SerializeObject(input);
            string json_output = ARC.GetTree(json_input);
            var output = JsonConvert.DeserializeObject<Model.GetTreeResponse>(json_output);

            Form2 obj = new Form2();
            obj.TextBoxMsg1 = json_input;
            obj.TextBoxMsg2 = json_output;
            obj.Show();
        }

        // ===== åŠŸèƒ½4ï¼šGetFuncBtn =====
        private void btnGetFuncBtn_Click(object sender, EventArgs e)
        {
            var input = new Model.GetFuncBtnRequest
            {
                SysID = txtSysID.Text,
                GroupID = txtGroupID.Text,
                FuncID = txtFuncID.Text,
                Environment = txtEnv.Text
            };

            string json_input = JsonConvert.SerializeObject(input);
            string json_output = ARC.GetFuncBtn(json_input);
            var output = JsonConvert.DeserializeObject<Model.GetFuncBtnResponse>(json_output);

            Form2 obj = new Form2();
            obj.TextBoxMsg1 = json_input;
            obj.TextBoxMsg2 = json_output;
            obj.Show();
        }

        // ===== åŠŸèƒ½5ï¼šCheckBtnEnabled =====
        private void btnCheckBtnEnabled_Click(object sender, EventArgs e)
        {
            var input = new Model.CheckBtnEnabledRequest
            {
                SysID = txtSysID.Text,
                GroupID = txtGroupID.Text,
                FuncID = txtFuncID.Text,
                BtnID = txtBtnID.Text,
                Environment = txtEnv.Text
            };

            string json_input = JsonConvert.SerializeObject(input);
            string json_output = ARC.CheckBtnEnabled(json_input);
            var output = JsonConvert.DeserializeObject<Model.CheckBtnEnabledResponse>(json_output);

            Form2 obj = new Form2();
            obj.TextBoxMsg1 = json_input;
            obj.TextBoxMsg2 = json_output;
            obj.Show();
        }

        // ===== åŠŸèƒ½6ï¼šGetFunctionAndAccessUrl =====
        private void btnGetFunctionAndAccessUrl_Click(object sender, EventArgs e)
        {
            var input = new Model.GetFunctionAndAccessUrlRequest
            {
                SysID = txtSysID.Text,
                UserAD = txtUserAD.Text,
                Environment = txtEnv.Text
            };

            string json_input = JsonConvert.SerializeObject(input);
            string json_output = ARC.GetFunctionAndAccessUrl(json_input);
            var output = JsonConvert.DeserializeObject<Model.GetFunctionAndAccessUrlResponse>(json_output);

            Form2 obj = new Form2();
            obj.TextBoxMsg1 = json_input;
            obj.TextBoxMsg2 = json_output;
            obj.Show();
        }

        // ===== åŠŸèƒ½7ï¼šGetAllUser =====
        private void btnGetAllUser_Click(object sender, EventArgs e)
        {
            var input = new Model.GetAllUserRequest
            {
                SysID = txtSysID.Text,
                Environment = txtEnv.Text
            };

            string json_input = JsonConvert.SerializeObject(input);
            string json_output = ARC.GetAllUser(json_input);
            var output = JsonConvert.DeserializeObject<Model.GetAllUserResponse>(json_output);

            Form2 obj = new Form2();
            obj.TextBoxMsg1 = json_input;
            obj.TextBoxMsg2 = json_output;
            obj.Show();
        }
    }
}


â¸»

ğŸ“Œ UI å°æ‡‰ï¼ˆForm1 ä¸Šçš„æ§åˆ¶å…ƒä»¶ï¼‰

å»ºè­°ä½ åœ¨ Form1 ä¸Šæ”¾é€™äº›è¼¸å…¥æ¡†ï¼ˆå°æ‡‰ Request åƒæ•¸ï¼‰ï¼š
	â€¢	txtSysID â†’ ç³»çµ±ä»£è™Ÿ
	â€¢	txtUserAD â†’ ä½¿ç”¨è€… AD
	â€¢	txtEnv â†’ ç’°å¢ƒï¼ˆTEST/PRODï¼‰
	â€¢	txtGroupID â†’ ç¾¤çµ„ä»£è™Ÿ
	â€¢	chkChildGroup â†’ æ˜¯å¦å–å­ç¾¤çµ„ï¼ˆCheckBoxï¼‰
	â€¢	txtFuncID â†’ åŠŸèƒ½ä»£è™Ÿï¼ˆFUNC_IDï¼‰
	â€¢	txtBtnID â†’ æŒ‰éˆ•ä»£è™Ÿï¼ˆBTN_IDï¼‰

ä¸ƒé¡†æŒ‰éˆ•åˆ†åˆ¥ç¶ä¸Šï¼š
	â€¢	btnGetUserData
	â€¢	btnGetGroupAllUser
	â€¢	btnGetTree
	â€¢	btnGetFuncBtn
	â€¢	btnCheckBtnEnabled
	â€¢	btnGetFunctionAndAccessUrl
	â€¢	btnGetAllUser

â¸»

è¦ä¸è¦æˆ‘å¹«ä½ æŠŠ Form1.Designer.cs çš„ UI é…ç½®ï¼ˆTextBoxã€CheckBoxã€Button æ’ç‰ˆï¼‰ä¹Ÿç”Ÿå‡ºä¾†ï¼Ÿ
é€™æ¨£ä½ ä¸ç”¨è‡ªå·±ä¸€é¡†é¡†æ‹‰å…ƒä»¶ï¼Ÿ