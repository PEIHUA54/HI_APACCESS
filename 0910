很好，你這份 JS 是完整的頁面管理程式碼。
你要改的是這一段 savePage() —— 目前它固定強制檢查 VIEW_H、VIEW_HB，導致 HOME 頁面沒填時報錯。

⸻

✅ 以下是修改後的建議版本（只需取代你現有的 savePage() 區塊）

function savePage() {
    const formData = {
        FUNC_ID: ($('#funcId').val() || '').trim(),
        FUNC_NA: ($('#funcName').val() || '').trim(),
        PARENT_ID: ($('#parentId').val() || '').trim() || null,
        SORT_NO: ($('#sortNo').val() || '').trim() || null,
        IS_SHOW: $('#isShow').val(),
        MEMO: ($('#memo').val() || '').trim() || null,
        VIEW_H: ($('#viewH').val() || '').trim(),
        VIEW_HB: ($('#viewHB').val() || '').trim()
    };

    // 頁面ID與名稱必填
    if (!formData.FUNC_ID || !formData.FUNC_NA) {
        alert('請輸入頁面ID和頁面名稱');
        return;
    }

    // 🔹 只有當 PARENT_ID 不是 HOME 時，才檢查 CONTROLLER 與 ACTION
    const needView = formData.PARENT_ID && formData.PARENT_ID.toUpperCase() !== 'HOME';
    if (needView && (!formData.VIEW_H || !formData.VIEW_HB)) {
        alert('請輸入 CONTROLLER 名稱與 ACTION 名稱');
        return;
    }

    // 🔹 HOME 頁面允許為空，確保送出時是 null
    if (!needView) {
        formData.VIEW_H = null;
        formData.VIEW_HB = null;
    }

    // 新增頁面時，上層必選
    if (!isPageEditMode && !formData.PARENT_ID) {
        alert('請選擇上層ID');
        return;
    }

    let url, postData;
    if (isPageEditMode) {
        url = '@Url.Action("UpdateFunction", "AP")';
        postData = Object.assign({}, formData, { originalFuncId: originalFuncId });
    } else {
        url = '@Url.Action("AddFunction", "AP")';
        postData = formData;
    }

    $.post(url, postData, function (response) {
        if (response.success) {
            alert(response.message);
            $('#pageModal').modal('hide');
            loadPages();

            // 若為編輯狀態，保持選中項目
            if (isPageEditMode) {
                setTimeout(function () {
                    currentSelectedPage = formData.FUNC_ID;
                    renderPageListHierarchical();
                }, 500);
            }
        } else {
            alert(response.message);
        }
    });
}


⸻

✅ 可選加強版（視覺提示）

若你想在選擇上層頁面時自動「鎖住 / 清空」VIEW_H 與 VIEW_HB，可在前面加這段：

// 🔸 當上層改變時，自動控制欄位啟用
$(document).on('change', '#parentId', function () {
    const parent = ($(this).val() || '').trim().toUpperCase();
    if (parent === 'HOME') {
        $('#viewH, #viewHB').val('').prop('disabled', true).attr('placeholder', 'HOME 不需填寫');
    } else {
        $('#viewH, #viewHB').prop('disabled', false).attr('placeholder', '');
    }
});


⸻

✅ 總結

條件	結果
PARENT_ID = “HOME”	VIEW_H、VIEW_HB 可為空、自動 disable、送出時轉成 null
其他情況	兩者必填，否則 alert
任何欄位 null 時不會再觸發 .trim() 錯誤	


⸻

是否要我順便幫你加上「HOME 時輸入框灰掉 + placeholder」的 UI 效果？那樣操作起來使用者也不會誤會需要填。