了解 ✅
如果你要 一進去 Modal 就有完整員工清單，那就不用等輸入 3 碼再查，而是直接把 VW_M1EMP_MAST 全部員工丟進 <datalist>。

⸻

🔧 修改步驟

1. 後端：GetEmployeeList

你現在有這個方法：

public List<EmployeeModel> GetEmployeeList(string keyword = "")
{
    string sql = @"
SELECT [EMP_NO], [EMP_NAME], [ORGAN_CAP], [POST_NAME]
FROM [HI_TMMAIN].[dbo].[VW_M1EMP_MAST]
WHERE 1=1";

    List<SqlParameter> parameters = new List<SqlParameter>();

    if (!string.IsNullOrWhiteSpace(keyword))
    {
        sql += " AND ([EMP_NO] LIKE @KEYWORD OR [EMP_NAME] LIKE @KEYWORD)";
        parameters.Add(new SqlParameter("@KEYWORD", $"%{keyword}%"));
    }

    sql += " ORDER BY [EMP_NO]";

    DataTable dt = SVS_DBmanager.QueryBySQL(sql, parameters);
    return SVS_DBmanager.ConvertToList<EmployeeModel>(dt);
}

👉 改法：如果 keyword 空，就回傳所有員工（例如 TOP 1000，避免一次塞太多）。

public List<EmployeeModel> GetEmployeeList(string keyword = "")
{
    string sql = @"
SELECT [EMP_NO], [EMP_NAME], [ORGAN_CAP], [POST_NAME]
FROM [HI_TMMAIN].[dbo].[VW_M1EMP_MAST]
WHERE 1=1";
    
    List<SqlParameter> parameters = new List<SqlParameter>();

    if (!string.IsNullOrWhiteSpace(keyword))
    {
        sql += " AND ([EMP_NO] LIKE @KEYWORD OR [EMP_NAME] LIKE @KEYWORD)";
        parameters.Add(new SqlParameter("@KEYWORD", $"%{keyword}%"));
    }

    // 建議加上 TOP 限制，避免資料過多造成前端爆炸
    sql = "SELECT TOP 1000 * FROM (" + sql + ") as T ORDER BY [EMP_NO]";

    DataTable dt = SVS_DBmanager.QueryBySQL(sql, parameters);
    return SVS_DBmanager.ConvertToList<EmployeeModel>(dt);
}


⸻

2. 前端：openUserModal() → 一進 Modal 就載入清單

function openUserModal() {
    $('#userForm')[0].reset();
    $('#empList').empty();

    // 🚀 一進去就撈全部清單
    $.get('@Url.Action("GetEmployeeList", "AP")', {}, function (res) {
        if (res.success && Array.isArray(res.data)) {
            const options = res.data.map(emp =>
                `<option value="${emp.EMP_NO}">${emp.EMP_NO} - ${emp.EMP_NAME} (${emp.ORGAN_CAP || ''})</option>`
            ).join('');
            $('#empList').html(options);
        }
    });

    // 綁定選擇事件（自動帶姓名/部門/職稱）
    $('#userIdInput').off('change blur').on('change blur', function () {
        const empNo = this.value.trim();
        if (!empNo) return;
        $.get('@Url.Action("GetEmployeeInfo", "AP")', { emp_no: empNo }, function (r) {
            if (r.success && r.data) {
                const emp = r.data;
                $('#userName').val(emp.EMP_NAME || '');
                $('#userDept').val(emp.ORGAN_CAP || '');
                $('#userPost').val(emp.POST_NAME || '');
            } else {
                $('#userName,#userDept,#userPost').val('');
            }
        });
    });

    $('#userModal').modal('show');
}


⸻

3. Modal HTML 保持不變

<input type="text" class="form-control" id="userIdInput" list="empList" placeholder="請輸入員工編號" required />
<datalist id="empList"></datalist>


⸻

✅ 完成效果
	•	打開「新增使用者」Modal → 下拉清單直接出現全部員工編號（例如 TOP 1000 筆）。
	•	也能輸入關鍵字快速定位。
	•	選中後會自動帶出姓名、部門、職稱。

⸻

要不要我幫你再做個 「如果員工超過 5000 筆，就只先載 1000 筆，輸入時再補查」 的版本？這樣可以避免 datalist 太大卡住。