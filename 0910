å¾ˆå¥½ï¼Œä½ é€™ä»½ JS æ˜¯å®Œæ•´çš„é é¢ç®¡ç†ç¨‹å¼ç¢¼ã€‚
ä½ è¦æ”¹çš„æ˜¯é€™ä¸€æ®µ savePage() â€”â€” ç›®å‰å®ƒå›ºå®šå¼·åˆ¶æª¢æŸ¥ VIEW_Hã€VIEW_HBï¼Œå°è‡´ HOME é é¢æ²’å¡«æ™‚å ±éŒ¯ã€‚

â¸»

âœ… ä»¥ä¸‹æ˜¯ä¿®æ”¹å¾Œçš„å»ºè­°ç‰ˆæœ¬ï¼ˆåªéœ€å–ä»£ä½ ç¾æœ‰çš„ savePage() å€å¡Šï¼‰

function savePage() {
    const formData = {
        FUNC_ID: ($('#funcId').val() || '').trim(),
        FUNC_NA: ($('#funcName').val() || '').trim(),
        PARENT_ID: ($('#parentId').val() || '').trim() || null,
        SORT_NO: ($('#sortNo').val() || '').trim() || null,
        IS_SHOW: $('#isShow').val(),
        MEMO: ($('#memo').val() || '').trim() || null,
        VIEW_H: ($('#viewH').val() || '').trim(),
        VIEW_HB: ($('#viewHB').val() || '').trim()
    };

    // é é¢IDèˆ‡åç¨±å¿…å¡«
    if (!formData.FUNC_ID || !formData.FUNC_NA) {
        alert('è«‹è¼¸å…¥é é¢IDå’Œé é¢åç¨±');
        return;
    }

    // ğŸ”¹ åªæœ‰ç•¶ PARENT_ID ä¸æ˜¯ HOME æ™‚ï¼Œæ‰æª¢æŸ¥ CONTROLLER èˆ‡ ACTION
    const needView = formData.PARENT_ID && formData.PARENT_ID.toUpperCase() !== 'HOME';
    if (needView && (!formData.VIEW_H || !formData.VIEW_HB)) {
        alert('è«‹è¼¸å…¥ CONTROLLER åç¨±èˆ‡ ACTION åç¨±');
        return;
    }

    // ğŸ”¹ HOME é é¢å…è¨±ç‚ºç©ºï¼Œç¢ºä¿é€å‡ºæ™‚æ˜¯ null
    if (!needView) {
        formData.VIEW_H = null;
        formData.VIEW_HB = null;
    }

    // æ–°å¢é é¢æ™‚ï¼Œä¸Šå±¤å¿…é¸
    if (!isPageEditMode && !formData.PARENT_ID) {
        alert('è«‹é¸æ“‡ä¸Šå±¤ID');
        return;
    }

    let url, postData;
    if (isPageEditMode) {
        url = '@Url.Action("UpdateFunction", "AP")';
        postData = Object.assign({}, formData, { originalFuncId: originalFuncId });
    } else {
        url = '@Url.Action("AddFunction", "AP")';
        postData = formData;
    }

    $.post(url, postData, function (response) {
        if (response.success) {
            alert(response.message);
            $('#pageModal').modal('hide');
            loadPages();

            // è‹¥ç‚ºç·¨è¼¯ç‹€æ…‹ï¼Œä¿æŒé¸ä¸­é …ç›®
            if (isPageEditMode) {
                setTimeout(function () {
                    currentSelectedPage = formData.FUNC_ID;
                    renderPageListHierarchical();
                }, 500);
            }
        } else {
            alert(response.message);
        }
    });
}


â¸»

âœ… å¯é¸åŠ å¼·ç‰ˆï¼ˆè¦–è¦ºæç¤ºï¼‰

è‹¥ä½ æƒ³åœ¨é¸æ“‡ä¸Šå±¤é é¢æ™‚è‡ªå‹•ã€Œé–ä½ / æ¸…ç©ºã€VIEW_H èˆ‡ VIEW_HBï¼Œå¯åœ¨å‰é¢åŠ é€™æ®µï¼š

// ğŸ”¸ ç•¶ä¸Šå±¤æ”¹è®Šæ™‚ï¼Œè‡ªå‹•æ§åˆ¶æ¬„ä½å•Ÿç”¨
$(document).on('change', '#parentId', function () {
    const parent = ($(this).val() || '').trim().toUpperCase();
    if (parent === 'HOME') {
        $('#viewH, #viewHB').val('').prop('disabled', true).attr('placeholder', 'HOME ä¸éœ€å¡«å¯«');
    } else {
        $('#viewH, #viewHB').prop('disabled', false).attr('placeholder', '');
    }
});


â¸»

âœ… ç¸½çµ

æ¢ä»¶	çµæœ
PARENT_ID = â€œHOMEâ€	VIEW_Hã€VIEW_HB å¯ç‚ºç©ºã€è‡ªå‹• disableã€é€å‡ºæ™‚è½‰æˆ null
å…¶ä»–æƒ…æ³	å…©è€…å¿…å¡«ï¼Œå¦å‰‡ alert
ä»»ä½•æ¬„ä½ null æ™‚ä¸æœƒå†è§¸ç™¼ .trim() éŒ¯èª¤	


â¸»

æ˜¯å¦è¦æˆ‘é †ä¾¿å¹«ä½ åŠ ä¸Šã€ŒHOME æ™‚è¼¸å…¥æ¡†ç°æ‰ + placeholderã€çš„ UI æ•ˆæœï¼Ÿé‚£æ¨£æ“ä½œèµ·ä¾†ä½¿ç”¨è€…ä¹Ÿä¸æœƒèª¤æœƒéœ€è¦å¡«ã€‚