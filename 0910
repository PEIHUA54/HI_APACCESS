æ‡‚äº† ğŸ‘
ä½ å¸Œæœ›åœ¨ WinForm æ¸¬è©¦å·¥å…·è£¡ï¼Œåƒ IsIncludeChildGroups / Environment / Type é€™äº›å€¼ï¼Œä¸ç”¨è¼¸å…¥æ–‡å­—ï¼Œè€Œæ˜¯ä¸‹æ‹‰é¸å–® (ComboBox) è®“ä½ ç›´æ¥é¸ã€‚é€™æ¨£å°±ä¸ç”¨æ“”å¿ƒæ‰“éŒ¯å­—ã€‚

æˆ‘å¹«ä½ è¨­è¨ˆå¥½ï¼š

â¸»

éœ€è¦çš„æ§åˆ¶é …è¨­è¨ˆ
	1.	IsIncludeChildGroups â†’ cmbChildGroup (ComboBox)
	â€¢	Items: true (åŒ…å«å­ç¾¤çµ„äººå“¡) / false (ä¸åŒ…å«å­ç¾¤çµ„)
	â€¢	é è¨­é¸ false
	2.	Environment â†’ cmbEnv (ComboBox)
	â€¢	Items: TEST (æ¸¬è©¦) / PROD (æ­£å¼)
	â€¢	é è¨­é¸ TEST
	3.	Type â†’ cmbType (ComboBox)
	â€¢	Items: 1 (é é¢&æŒ‰éˆ•è¨­å®š) / 2 (æ¬Šé™è¨­å®š)
	â€¢	é è¨­é¸ 1

â¸»

Designer.cs (ç‰‡æ®µç¯„ä¾‹)

private System.Windows.Forms.ComboBox cmbChildGroup;
private System.Windows.Forms.ComboBox cmbEnv;
private System.Windows.Forms.ComboBox cmbType;

private void InitializeComponent()
{
    this.cmbChildGroup = new System.Windows.Forms.ComboBox();
    this.cmbEnv = new System.Windows.Forms.ComboBox();
    this.cmbType = new System.Windows.Forms.ComboBox();

    // 
    // cmbChildGroup
    // 
    this.cmbChildGroup.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
    this.cmbChildGroup.Items.AddRange(new object[] {
        "true:åŒ…å«å­ç¾¤çµ„äººå“¡",
        "false:ä¸åŒ…å«å­ç¾¤"});
    this.cmbChildGroup.SelectedIndex = 1; // é è¨­é¸ false
    this.cmbChildGroup.Location = new System.Drawing.Point(120, 30);
    this.cmbChildGroup.Name = "cmbChildGroup";
    this.cmbChildGroup.Size = new System.Drawing.Size(200, 23);

    // 
    // cmbEnv
    // 
    this.cmbEnv.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
    this.cmbEnv.Items.AddRange(new object[] {
        "TEST:æ¸¬è©¦",
        "PROD:æ­£å¼"});
    this.cmbEnv.SelectedIndex = 0; // é è¨­ TEST
    this.cmbEnv.Location = new System.Drawing.Point(120, 70);
    this.cmbEnv.Name = "cmbEnv";
    this.cmbEnv.Size = new System.Drawing.Size(200, 23);

    // 
    // cmbType
    // 
    this.cmbType.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
    this.cmbType.Items.AddRange(new object[] {
        "1:é é¢&æŒ‰éˆ•è¨­å®š",
        "2:æ¬Šé™è¨­å®š"});
    this.cmbType.SelectedIndex = 0; // é è¨­ 1
    this.cmbType.Location = new System.Drawing.Point(120, 110);
    this.cmbType.Name = "cmbType";
    this.cmbType.Size = new System.Drawing.Size(200, 23);

    // æŠŠæ§åˆ¶é …åŠ é€² Form
    this.Controls.Add(this.cmbChildGroup);
    this.Controls.Add(this.cmbEnv);
    this.Controls.Add(this.cmbType);
}


â¸»

åœ¨ç¨‹å¼å–å€¼

bool isIncludeChild = cmbChildGroup.SelectedItem.ToString().StartsWith("true");
string environment = cmbEnv.SelectedItem.ToString().StartsWith("TEST") ? "TEST" : "PROD";
string type = cmbType.SelectedItem.ToString().StartsWith("1") ? "1" : "2";


â¸»

è¦ä¸è¦æˆ‘å¹«ä½ æŠŠ Form1.Designer.cs + Form1.cs å®Œæ•´ç¯„ä¾‹ï¼ˆå«ä¸ƒå€‹æŒ‰éˆ•çš„äº‹ä»¶ï¼‰éƒ½ç”Ÿæˆå¥½ï¼Ÿ
é€™æ¨£ä½ ç›´æ¥è¤‡è£½å°±èƒ½è·‘æ¸¬è©¦ï¼Œä¸ç”¨å†è‡ªå·±åŠ æ§åˆ¶é …ã€‚

å¥½ ğŸ‘ æˆ‘å¹«ä½ æŠŠ Form1.Designer.cs + Form1.cs ç”¢å®Œæ•´ç¯„ä¾‹ï¼ŒåŒ…å«ä¸ƒå€‹æŒ‰éˆ•ï¼ˆå°æ‡‰ 7 å€‹åŠŸèƒ½ APIï¼‰ã€ä¸‰å€‹ä¸‹æ‹‰é¸å–®ï¼ˆIsIncludeChildGroups / Environment / Typeï¼‰ï¼Œä»¥åŠ Request / Response çš„é¡¯ç¤ºæ–¹å¼ã€‚

â¸»

ğŸ”¹ Form1.Designer.cs

namespace HI_APACCESS_DLL_TEST
{
    partial class Form1
    {
        private System.ComponentModel.IContainer components = null;

        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        private void InitializeComponent()
        {
            this.txtSysID = new System.Windows.Forms.TextBox();
            this.txtUserAD = new System.Windows.Forms.TextBox();
            this.txtGroupID = new System.Windows.Forms.TextBox();
            this.txtFuncID = new System.Windows.Forms.TextBox();
            this.txtBtnID = new System.Windows.Forms.TextBox();

            this.cmbChildGroup = new System.Windows.Forms.ComboBox();
            this.cmbEnv = new System.Windows.Forms.ComboBox();
            this.cmbType = new System.Windows.Forms.ComboBox();

            this.btnFunc1 = new System.Windows.Forms.Button();
            this.btnFunc2 = new System.Windows.Forms.Button();
            this.btnFunc3 = new System.Windows.Forms.Button();
            this.btnFunc4 = new System.Windows.Forms.Button();
            this.btnFunc5 = new System.Windows.Forms.Button();
            this.btnFunc6 = new System.Windows.Forms.Button();
            this.btnFunc7 = new System.Windows.Forms.Button();

            this.SuspendLayout();

            // ====== TextBoxes ======
            this.txtSysID.Location = new System.Drawing.Point(30, 20);
            this.txtSysID.Name = "txtSysID";
            this.txtSysID.PlaceholderText = "SysID";
            this.txtSysID.Size = new System.Drawing.Size(200, 23);

            this.txtUserAD.Location = new System.Drawing.Point(30, 60);
            this.txtUserAD.Name = "txtUserAD";
            this.txtUserAD.PlaceholderText = "UserAD";
            this.txtUserAD.Size = new System.Drawing.Size(200, 23);

            this.txtGroupID.Location = new System.Drawing.Point(30, 100);
            this.txtGroupID.Name = "txtGroupID";
            this.txtGroupID.PlaceholderText = "GroupID";
            this.txtGroupID.Size = new System.Drawing.Size(200, 23);

            this.txtFuncID.Location = new System.Drawing.Point(30, 140);
            this.txtFuncID.Name = "txtFuncID";
            this.txtFuncID.PlaceholderText = "FuncID";
            this.txtFuncID.Size = new System.Drawing.Size(200, 23);

            this.txtBtnID.Location = new System.Drawing.Point(30, 180);
            this.txtBtnID.Name = "txtBtnID";
            this.txtBtnID.PlaceholderText = "BtnID";
            this.txtBtnID.Size = new System.Drawing.Size(200, 23);

            // ====== ComboBoxes ======
            this.cmbChildGroup.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbChildGroup.Items.AddRange(new object[] {
                "true:åŒ…å«å­ç¾¤çµ„äººå“¡",
                "false:ä¸åŒ…å«å­ç¾¤"});
            this.cmbChildGroup.SelectedIndex = 1;
            this.cmbChildGroup.Location = new System.Drawing.Point(30, 220);
            this.cmbChildGroup.Size = new System.Drawing.Size(200, 23);

            this.cmbEnv.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbEnv.Items.AddRange(new object[] {
                "TEST:æ¸¬è©¦",
                "PROD:æ­£å¼"});
            this.cmbEnv.SelectedIndex = 0;
            this.cmbEnv.Location = new System.Drawing.Point(30, 260);
            this.cmbEnv.Size = new System.Drawing.Size(200, 23);

            this.cmbType.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbType.Items.AddRange(new object[] {
                "1:é é¢&æŒ‰éˆ•è¨­å®š",
                "2:æ¬Šé™è¨­å®š"});
            this.cmbType.SelectedIndex = 0;
            this.cmbType.Location = new System.Drawing.Point(30, 300);
            this.cmbType.Size = new System.Drawing.Size(200, 23);

            // ====== Buttons ======
            this.btnFunc1.Location = new System.Drawing.Point(270, 20);
            this.btnFunc1.Name = "btnFunc1";
            this.btnFunc1.Size = new System.Drawing.Size(150, 30);
            this.btnFunc1.Text = "åŠŸèƒ½1 GetUserData";
            this.btnFunc1.Click += new System.EventHandler(this.btnFunc1_Click);

            this.btnFunc2.Location = new System.Drawing.Point(270, 60);
            this.btnFunc2.Size = new System.Drawing.Size(150, 30);
            this.btnFunc2.Text = "åŠŸèƒ½2 GetGroupAllUser";
            this.btnFunc2.Click += new System.EventHandler(this.btnFunc2_Click);

            this.btnFunc3.Location = new System.Drawing.Point(270, 100);
            this.btnFunc3.Size = new System.Drawing.Size(150, 30);
            this.btnFunc3.Text = "åŠŸèƒ½3 GetTree";
            this.btnFunc3.Click += new System.EventHandler(this.btnFunc3_Click);

            this.btnFunc4.Location = new System.Drawing.Point(270, 140);
            this.btnFunc4.Size = new System.Drawing.Size(150, 30);
            this.btnFunc4.Text = "åŠŸèƒ½4 GetFuncBtn";
            this.btnFunc4.Click += new System.EventHandler(this.btnFunc4_Click);

            this.btnFunc5.Location = new System.Drawing.Point(270, 180);
            this.btnFunc5.Size = new System.Drawing.Size(150, 30);
            this.btnFunc5.Text = "åŠŸèƒ½5 CheckBtnEnabled";
            this.btnFunc5.Click += new System.EventHandler(this.btnFunc5_Click);

            this.btnFunc6.Location = new System.Drawing.Point(270, 220);
            this.btnFunc6.Size = new System.Drawing.Size(150, 30);
            this.btnFunc6.Text = "åŠŸèƒ½6 GetFunctionAndAccessUrl";
            this.btnFunc6.Click += new System.EventHandler(this.btnFunc6_Click);

            this.btnFunc7.Location = new System.Drawing.Point(270, 260);
            this.btnFunc7.Size = new System.Drawing.Size(150, 30);
            this.btnFunc7.Text = "åŠŸèƒ½7 GetAllUser";
            this.btnFunc7.Click += new System.EventHandler(this.btnFunc7_Click);

            // ====== Form1 ======
            this.ClientSize = new System.Drawing.Size(450, 350);
            this.Controls.Add(this.txtSysID);
            this.Controls.Add(this.txtUserAD);
            this.Controls.Add(this.txtGroupID);
            this.Controls.Add(this.txtFuncID);
            this.Controls.Add(this.txtBtnID);

            this.Controls.Add(this.cmbChildGroup);
            this.Controls.Add(this.cmbEnv);
            this.Controls.Add(this.cmbType);

            this.Controls.Add(this.btnFunc1);
            this.Controls.Add(this.btnFunc2);
            this.Controls.Add(this.btnFunc3);
            this.Controls.Add(this.btnFunc4);
            this.Controls.Add(this.btnFunc5);
            this.Controls.Add(this.btnFunc6);
            this.Controls.Add(this.btnFunc7);

            this.Name = "Form1";
            this.Text = "HI_APACCESS æ¸¬è©¦å·¥å…·";
            this.ResumeLayout(false);
            this.PerformLayout();
        }

        #endregion

        private System.Windows.Forms.TextBox txtSysID;
        private System.Windows.Forms.TextBox txtUserAD;
        private System.Windows.Forms.TextBox txtGroupID;
        private System.Windows.Forms.TextBox txtFuncID;
        private System.Windows.Forms.TextBox txtBtnID;

        private System.Windows.Forms.ComboBox cmbChildGroup;
        private System.Windows.Forms.ComboBox cmbEnv;
        private System.Windows.Forms.ComboBox cmbType;

        private System.Windows.Forms.Button btnFunc1;
        private System.Windows.Forms.Button btnFunc2;
        private System.Windows.Forms.Button btnFunc3;
        private System.Windows.Forms.Button btnFunc4;
        private System.Windows.Forms.Button btnFunc5;
        private System.Windows.Forms.Button btnFunc6;
        private System.Windows.Forms.Button btnFunc7;
    }
}


â¸»

ğŸ”¹ Form1.cs

using Newtonsoft.Json;
using System;
using System.Windows.Forms;

namespace HI_APACCESS_DLL_TEST
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        // å– ComboBox å€¼
        private string GetEnvironment() =>
            cmbEnv.SelectedItem.ToString().StartsWith("TEST") ? "TEST" : "PROD";

        private bool GetIsIncludeChild() =>
            cmbChildGroup.SelectedItem.ToString().StartsWith("true");

        private string GetTypeValue() =>
            cmbType.SelectedItem.ToString().StartsWith("1") ? "1" : "2";

        // ===== åŠŸèƒ½1 GetUserData =====
        private void btnFunc1_Click(object sender, EventArgs e)
        {
            var req = new Model.GetUserDataRequest
            {
                SysID = txtSysID.Text,
                UserAD = txtUserAD.Text,
                Environment = GetEnvironment()
            };
            string jsonReq = JsonConvert.SerializeObject(req);
            string jsonRes = new HI_APACCESS_DLL.APACCESS().GetUserNameAndGroup(jsonReq);
            var res = JsonConvert.DeserializeObject<Model.GetUserDataResponse>(jsonRes);

            ShowResult(jsonReq, jsonRes);
        }

        // ===== åŠŸèƒ½2 GetGroupAllUser =====
        private void btnFunc2_Click(object sender, EventArgs e)
        {
            var req = new Model.GetGroupAllUserRequest
            {
                SysID = txtSysID.Text,
                GroupID = txtGroupID.Text,
                IsIncludeChildGroups = GetIsIncludeChild(),
                Environment = GetEnvironment()
            };
            string jsonReq = JsonConvert.SerializeObject(req);
            string jsonRes = new HI_APACCESS_DLL.APACCESS().GetGroupAllUser(jsonReq);
            var res = JsonConvert.DeserializeObject<Model.GetGroupAllUserResponse>(jsonRes);

            ShowResult(jsonReq, jsonRes);
        }

        // ===== åŠŸèƒ½3 GetTree =====
        private void btnFunc3_Click(object sender, EventArgs e)
        {
            var req = new Model.GetTreeRequest
            {
                SysID = txtSysID.Text,
                GroupID = txtGroupID.Text,
                Environment = GetEnvironment()
            };
            string jsonReq = JsonConvert.SerializeObject(req);
            string jsonRes = new HI_APACCESS_DLL.APACCESS().GetTree(jsonReq);
            var res = JsonConvert.DeserializeObject<Model.GetTreeResponse>(jsonRes);

            ShowResult(jsonReq, jsonRes);
        }

        // ===== åŠŸèƒ½4 GetFuncBtn =====
        private void btnFunc4_Click(object sender, EventArgs e)
        {
            var req = new Model.GetFuncBtnRequest
            {
                SysID = txtSysID.Text,
                GroupID = txtGroupID.Text,
                FuncID = txtFuncID.Text,
                Environment = GetEnvironment()
            };
            string jsonReq = JsonConvert.SerializeObject(req);
            string jsonRes = new HI_APACCESS_DLL.APACCESS().GetFuncBtn(jsonReq);
            var res = JsonConvert.DeserializeObject<Model.GetFuncBtnResponse>(jsonRes);

            ShowResult(jsonReq, jsonRes);
        }

        // ===== åŠŸèƒ½5 CheckBtnEnabled =====
        private void btnFunc5_Click(object sender, EventArgs e)
        {
            var req = new Model.CheckBtnEnabledRequest
            {
                SysID = txtSysID.Text,
                GroupID = txtGroupID.Text,
                FuncID = txtFuncID.Text,
                BtnID = txtBtnID.Text,
                Environment = GetEnvironment()
            };
            string jsonReq = JsonConvert.SerializeObject(req);
            string jsonRes = new HI_APACCESS_DLL.APACCESS().CheckBtnEnabled(jsonReq);
            var res = JsonConvert.DeserializeObject<Model.CheckBtnEnabledResponse>(jsonRes);

            ShowResult(jsonReq, jsonRes);
        }

        // ===== åŠŸèƒ½6 GetFunctionAndAccessUrl =====
        private void btnFunc6_Click(object sender, EventArgs e)
        {
            var req = new Model.GetFunctionAndAccessUrlRequest
            {
                SysID = txtSysID.Text,
                UserAD = txtUserAD.Text,
                Environment = GetEnvironment()
            };
            string jsonReq = JsonConvert.SerializeObject(req);
            string jsonRes = new HI_APACCESS_DLL.APACCESS().GetFunctionAndAccessUrl(jsonReq);
            var res = JsonConvert.DeserializeObject<Model.GetFunctionAndAccessUrlResponse>(jsonRes);

            ShowResult(jsonReq, jsonRes);
        }

        // ===== åŠŸèƒ½7 GetAllUser =====
        private void btnFunc7_Click(object sender, EventArgs e)
        {
            var req = new Model.GetAllUserRequest
            {
                SysID = txtSysID.Text,
                Environment = GetEnvironment()
            };
            string jsonReq = JsonConvert.SerializeObject(req);
            string jsonRes = new HI_APACCESS_DLL.APACCESS().GetAllUser(jsonReq);
            var res = JsonConvert.DeserializeObject<Model.GetAllUserResponse>(jsonRes);

            ShowResult(jsonReq, jsonRes);
        }

        // é¡¯ç¤º Request & Response
        private void ShowResult(string req, string res)
        {
            Form2 f = new Form2();
            f.TextBoxMsg1 = req;
            f.TextBoxMsg2 = res;
            f.Show();
        }
    }
}


â¸»

é€™æ¨£å°±å®Œæˆäº†ï¼š

âœ… 7 å€‹æŒ‰éˆ•å°æ‡‰ DLL çš„ 7 åŠŸèƒ½
âœ… ComboBox ä¸‹æ‹‰é¸å–®é¿å…æ‰‹å‹•è¼¸å…¥éŒ¯èª¤
âœ… Request / Response é¡¯ç¤ºåœ¨ Form2

â¸»

è¦ä¸è¦æˆ‘é †ä¾¿å¹«ä½ æŠŠ Form2.Designer.cs + Form2.cs ä¹Ÿç”Ÿå®Œæ•´ï¼Ÿï¼ˆå…©å€‹ TextBox å°ˆé–€é¡¯ç¤º Request / Responseï¼‰