æ‡‚äº† âœ…
ä½ å¸Œæœ›åœ¨ å‰ç«¯é¡¯ç¤ºçš„è¨Šæ¯å€å¡Š æ˜ç¢ºåˆ†æˆ ä¸‰ç¨®ç‹€æ…‹ï¼š
	1.	å®Œå…¨æˆåŠŸ
	â€¢	é¡¯ç¤ºç¶ è‰²æ¡†ï¼š åŒ¯å…¥æˆåŠŸï¼šå…± X ç­†
	2.	å®Œå…¨å¤±æ•—
	â€¢	é¡¯ç¤ºç´…è‰²æ¡†ï¼š åŒ¯å…¥å¤±æ•—ï¼šè«‹é‡æ–°ä¸Šå‚³
	â€¢	ä¸‹æ–¹ä¸éœ€è¦é¡¯ç¤ºæˆåŠŸç­†æ•¸ï¼Œä½†å¯ä»¥ç›´æ¥é¡¯ç¤ºéŒ¯èª¤æ¸…å–®
	3.	éƒ¨åˆ†æˆåŠŸ
	â€¢	é¡¯ç¤ºé»ƒè‰²æ¡†ï¼š åŒ¯å…¥éƒ¨åˆ†æˆåŠŸï¼šæˆåŠŸ X ç­†ï¼Œå¤±æ•— Y ç­†
	â€¢	ä¸‹æ–¹éŒ¯èª¤æ¸…å–®é¡¯ç¤ºå¤±æ•—ç­†æ•¸çš„æ˜ç´°

â¸»

ğŸ”§ Controller (å›å‚³çµæ§‹)

ä½ ç¾åœ¨çš„ ImportUsers action å¯ä»¥æ”¹æˆé€™æ¨£ï¼š

if (importResult.SuccessCount > 0 && importResult.ErrorMessages.Count == 0)
{
    // âœ… å…¨éƒ¨æˆåŠŸ
    return Json(new
    {
        status = "success",
        message = $"åŒ¯å…¥æˆåŠŸï¼šå…± {importResult.SuccessCount} ç­†"
    });
}
else if (importResult.SuccessCount == 0 && importResult.ErrorMessages.Count > 0)
{
    // âŒ å…¨éƒ¨å¤±æ•—
    return Json(new
    {
        status = "fail",
        message = "åŒ¯å…¥å¤±æ•—ï¼šè«‹é‡æ–°ä¸Šå‚³",
        errors = importResult.ErrorMessages
    });
}
else
{
    // âš ï¸ éƒ¨åˆ†æˆåŠŸ
    return Json(new
    {
        status = "partial",
        message = $"åŒ¯å…¥éƒ¨åˆ†æˆåŠŸï¼šæˆåŠŸ {importResult.SuccessCount} ç­†ï¼Œå¤±æ•— {importResult.ErrorMessages.Count} ç­†",
        errors = importResult.ErrorMessages
    });
}

é€™è£¡æˆ‘æŠŠ success æ›æˆ statusï¼ˆå–å€¼ "success" | "fail" | "partial"ï¼‰ï¼Œæ–¹ä¾¿å‰ç«¯åˆ¤æ–·ã€‚

â¸»

ğŸ”§ JS (è™•ç†ä¸‰ç¨®ç‹€æ…‹)

$("#importForm").submit(function (e) {
    e.preventDefault();
    var formData = new FormData(this);

    $("#uploadProgress").removeClass("d-none");
    $(".progress-bar").css("width", "50%");

    $.ajax({
        url: '@Url.Action("ImportUsers", "AP")',
        type: 'POST',
        data: formData,
        contentType: false,
        processData: false,
        success: function (res) {
            $("#uploadProgress").addClass("d-none");
            $(".progress-bar").css("width", "0%");
            
            // æ¸…ç©ºèˆŠçš„è¨Šæ¯å€å¡Š
            $("#successSection, #errorSection, #partialSection").addClass("d-none");
            $("#errorTable tbody").empty();

            if (res.status === "success") {
                // âœ… å…¨éƒ¨æˆåŠŸ
                $("#successMessage").text(res.message);
                $("#successSection").removeClass("d-none");
                loadUsers();
            }
            else if (res.status === "fail") {
                // âŒ å…¨éƒ¨å¤±æ•—
                $("#errorMessage").text(res.message);
                $("#errorSection").removeClass("d-none");

                if (res.errors && res.errors.length > 0) {
                    res.errors.forEach(err => {
                        $("#errorTable tbody").append(
                            `<tr class="table-danger">
                                <td>${err.RowNumber}</td>
                                <td>${err.EmpNo}</td>
                                <td>${err.Message}</td>
                            </tr>`
                        );
                    });
                }
            }
            else if (res.status === "partial") {
                // âš ï¸ éƒ¨åˆ†æˆåŠŸ
                $("#partialMessage").text(res.message);
                $("#partialSection").removeClass("d-none");

                if (res.errors && res.errors.length > 0) {
                    res.errors.forEach(err => {
                        $("#errorTable tbody").append(
                            `<tr class="table-warning">
                                <td>${err.RowNumber}</td>
                                <td>${err.EmpNo}</td>
                                <td>${err.Message}</td>
                            </tr>`
                        );
                    });
                }

                loadUsers();
            }
        },
        error: function () {
            $("#uploadProgress").addClass("d-none");
            $(".progress-bar").css("width", "0%");
            alert("ä¼ºæœå™¨ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
        }
    });
});


â¸»

ğŸ”§ View (è¨Šæ¯å€å¡Š)

åœ¨ modal è£¡å¤šåŠ ä¸€å€‹é»ƒè‰²çš„ éƒ¨åˆ†æˆåŠŸå€å¡Šï¼š

<!-- æˆåŠŸé¡¯ç¤º -->
<div id="successSection" class="mt-4 d-none">
    <div class="alert alert-success">
        <strong id="successMessage"></strong>
    </div>
</div>

<!-- å¤±æ•—é¡¯ç¤º -->
<div id="errorSection" class="mt-4 d-none">
    <div class="alert alert-danger">
        <strong id="errorMessage"></strong>
    </div>
    <div class="table-responsive mt-2">
        <table class="table table-bordered table-striped" id="errorTable">
            <thead class="table-dark">
                <tr>
                    <th>è¡Œè™Ÿ</th>
                    <th>å“¡ç·¨</th>
                    <th>éŒ¯èª¤è¨Šæ¯</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<!-- éƒ¨åˆ†æˆåŠŸé¡¯ç¤º -->
<div id="partialSection" class="mt-4 d-none">
    <div class="alert alert-warning">
        <strong id="partialMessage"></strong>
    </div>
    <div class="table-responsive mt-2">
        <table class="table table-bordered table-striped" id="errorTable">
            <thead class="table-dark">
                <tr>
                    <th>è¡Œè™Ÿ</th>
                    <th>å“¡ç·¨</th>
                    <th>éŒ¯èª¤è¨Šæ¯</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>


â¸»

âœ… é€™æ¨£å°±æœƒæœ‰ ä¸‰ç¨®ä¸åŒé¡è‰²çš„è¨Šæ¯æ¡†ï¼š
	â€¢	ç¶ è‰²ï¼ˆæˆåŠŸï¼‰
	â€¢	ç´…è‰²ï¼ˆå¤±æ•—ï¼‰
	â€¢	é»ƒè‰²ï¼ˆéƒ¨åˆ†æˆåŠŸï¼Œé™„éŒ¯èª¤æ¸…å–®ï¼‰

â¸»

è¦ä¸è¦æˆ‘å¹«ä½ æŠŠ éŒ¯èª¤è¡¨æ ¼ errorTable æ”¹æˆå…±ç”¨ä¸€å€‹ï¼Œé¿å… fail/partial å„è‡ªé‡è¤‡ä¸€ä»½è¡¨æ ¼ï¼Ÿ