懂了 ✅
你希望在 前端顯示的訊息區塊 明確分成 三種狀態：
	1.	完全成功
	•	顯示綠色框： 匯入成功：共 X 筆
	2.	完全失敗
	•	顯示紅色框： 匯入失敗：請重新上傳
	•	下方不需要顯示成功筆數，但可以直接顯示錯誤清單
	3.	部分成功
	•	顯示黃色框： 匯入部分成功：成功 X 筆，失敗 Y 筆
	•	下方錯誤清單顯示失敗筆數的明細

⸻

🔧 Controller (回傳結構)

你現在的 ImportUsers action 可以改成這樣：

if (importResult.SuccessCount > 0 && importResult.ErrorMessages.Count == 0)
{
    // ✅ 全部成功
    return Json(new
    {
        status = "success",
        message = $"匯入成功：共 {importResult.SuccessCount} 筆"
    });
}
else if (importResult.SuccessCount == 0 && importResult.ErrorMessages.Count > 0)
{
    // ❌ 全部失敗
    return Json(new
    {
        status = "fail",
        message = "匯入失敗：請重新上傳",
        errors = importResult.ErrorMessages
    });
}
else
{
    // ⚠️ 部分成功
    return Json(new
    {
        status = "partial",
        message = $"匯入部分成功：成功 {importResult.SuccessCount} 筆，失敗 {importResult.ErrorMessages.Count} 筆",
        errors = importResult.ErrorMessages
    });
}

這裡我把 success 換成 status（取值 "success" | "fail" | "partial"），方便前端判斷。

⸻

🔧 JS (處理三種狀態)

$("#importForm").submit(function (e) {
    e.preventDefault();
    var formData = new FormData(this);

    $("#uploadProgress").removeClass("d-none");
    $(".progress-bar").css("width", "50%");

    $.ajax({
        url: '@Url.Action("ImportUsers", "AP")',
        type: 'POST',
        data: formData,
        contentType: false,
        processData: false,
        success: function (res) {
            $("#uploadProgress").addClass("d-none");
            $(".progress-bar").css("width", "0%");
            
            // 清空舊的訊息區塊
            $("#successSection, #errorSection, #partialSection").addClass("d-none");
            $("#errorTable tbody").empty();

            if (res.status === "success") {
                // ✅ 全部成功
                $("#successMessage").text(res.message);
                $("#successSection").removeClass("d-none");
                loadUsers();
            }
            else if (res.status === "fail") {
                // ❌ 全部失敗
                $("#errorMessage").text(res.message);
                $("#errorSection").removeClass("d-none");

                if (res.errors && res.errors.length > 0) {
                    res.errors.forEach(err => {
                        $("#errorTable tbody").append(
                            `<tr class="table-danger">
                                <td>${err.RowNumber}</td>
                                <td>${err.EmpNo}</td>
                                <td>${err.Message}</td>
                            </tr>`
                        );
                    });
                }
            }
            else if (res.status === "partial") {
                // ⚠️ 部分成功
                $("#partialMessage").text(res.message);
                $("#partialSection").removeClass("d-none");

                if (res.errors && res.errors.length > 0) {
                    res.errors.forEach(err => {
                        $("#errorTable tbody").append(
                            `<tr class="table-warning">
                                <td>${err.RowNumber}</td>
                                <td>${err.EmpNo}</td>
                                <td>${err.Message}</td>
                            </tr>`
                        );
                    });
                }

                loadUsers();
            }
        },
        error: function () {
            $("#uploadProgress").addClass("d-none");
            $(".progress-bar").css("width", "0%");
            alert("伺服器發生錯誤，請稍後再試。");
        }
    });
});


⸻

🔧 View (訊息區塊)

在 modal 裡多加一個黃色的 部分成功區塊：

<!-- 成功顯示 -->
<div id="successSection" class="mt-4 d-none">
    <div class="alert alert-success">
        <strong id="successMessage"></strong>
    </div>
</div>

<!-- 失敗顯示 -->
<div id="errorSection" class="mt-4 d-none">
    <div class="alert alert-danger">
        <strong id="errorMessage"></strong>
    </div>
    <div class="table-responsive mt-2">
        <table class="table table-bordered table-striped" id="errorTable">
            <thead class="table-dark">
                <tr>
                    <th>行號</th>
                    <th>員編</th>
                    <th>錯誤訊息</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<!-- 部分成功顯示 -->
<div id="partialSection" class="mt-4 d-none">
    <div class="alert alert-warning">
        <strong id="partialMessage"></strong>
    </div>
    <div class="table-responsive mt-2">
        <table class="table table-bordered table-striped" id="errorTable">
            <thead class="table-dark">
                <tr>
                    <th>行號</th>
                    <th>員編</th>
                    <th>錯誤訊息</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>


⸻

✅ 這樣就會有 三種不同顏色的訊息框：
	•	綠色（成功）
	•	紅色（失敗）
	•	黃色（部分成功，附錯誤清單）

⸻

要不要我幫你把 錯誤表格 errorTable 改成共用一個，避免 fail/partial 各自重複一份表格？