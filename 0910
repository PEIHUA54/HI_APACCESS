非常好 👌
你問得對，第 8 點我之前只寫修改重點，這裡我直接給你 完整、可貼上替換的兩個函式（updateButtonListHierarchical() 和 loadButtonsForPage()） ，已完整整合「001 可操作、非001唯讀」邏輯。
同時也保持你原本的版型、樣式、載入順序。

⸻

✅ 一、完整替換 updateButtonListHierarchical()

// 階層式更新按鈕列表（依登入身分決定是否唯讀）
function updateButtonListHierarchical() {
    if (allFunctions.length === 0) {
        $('#buttonList').html('<div class="no-data">無可用頁面</div>');
        return;
    }

    const isAdmin = (currentGroupID === '001');
    const parentChildMap = {};
    const parentPages = [];

    // 分離父頁面與子頁面
    allFunctions.forEach(func => {
        const funcId = getFuncId(func);
        const parentId = getParentId(func);

        if (!parentId || parentId === '' || parentId === 'HOME') {
            parentPages.push(func);
            parentChildMap[funcId] = parentChildMap[funcId] || [];
        } else if (func.IS_SHOW === 'Y') {
            parentChildMap[parentId] = parentChildMap[parentId] || [];
            parentChildMap[parentId].push(func);
        }
    });

    // 依排序排序
    parentPages.sort((a, b) => (parseInt(a.SORT_NO) || 999) - (parseInt(b.SORT_NO) || 999));
    Object.keys(parentChildMap).forEach(pid => {
        parentChildMap[pid].sort((a, b) => (parseInt(a.SORT_NO) || 999) - (parseInt(b.SORT_NO) || 999));
    });

    let html = '';

    parentPages.forEach(parentFunc => {
        const parentId = getFuncId(parentFunc);
        const parentName = getFuncName(parentFunc);
        const children = parentChildMap[parentId] || [];

        // 父頁面 header
        html += `
        <div class="parent-page-header" id="parent-header-${parentId}">
            <i class="fas fa-folder"></i> ${parentName}
            <small class="text-muted" style="margin-left:10px;">(${parentId})</small>
        </div>`;

        // 父頁面按鈕區塊
        const parentHasPagePermission = groupPermissions[parentId] && groupPermissions[parentId].hasPagePermission;
        const parentSectionStyle = parentHasPagePermission
            ? 'margin-bottom:15px;border:1px solid #dee2e6;border-radius:6px;background:#f8f9fa;margin-left:20px;'
            : 'margin-bottom:15px;border:1px solid #dee2e6;border-radius:6px;background:#f5f5f5;opacity:0.6;margin-left:20px;';

        html += `
        <div class="page-section parent-section" id="page-section-${parentId}" style="${parentSectionStyle}">
            <div class="page-header" style="background:#e9ecef;padding:10px 15px;border-bottom:1px solid #dee2e6;font-weight:bold;color:#495057;display:flex;justify-content:space-between;align-items:center;">
                <span>
                    <i class="fas fa-folder-open"></i> ${parentName}
                    <small class="text-muted" style="margin-left:10px;">(${parentId})</small>
                </span>
                <div style="display:flex;gap:5px;">
                    ${isAdmin ? `
                    <button type="button" class="btn btn-sm btn-primary" onclick="selectAllButtons('${parentId}')" style="font-size:11px;padding:2px 8px;" ${!parentHasPagePermission ? 'disabled' : ''}>
                        <i class="fas fa-check-square"></i> 全勾選
                    </button>
                    <button type="button" class="btn btn-sm btn-secondary" onclick="clearAllButtons('${parentId}')" style="font-size:11px;padding:2px 8px;" ${!parentHasPagePermission ? 'disabled' : ''}>
                        <i class="fas fa-square"></i> 全取消
                    </button>` : ''}
                </div>
            </div>
            <div class="buttons-container" id="buttons-${parentId}" style="padding:10px;">
                <div class="no-data"><i class="fas fa-spinner fa-spin"></i> 載入中...</div>
            </div>`;

        // 子頁面
        if (children.length > 0) {
            html += `<div style="margin:10px 15px;border-top:2px solid #6c757d;"></div>`;
            children.forEach(childFunc => {
                const funcId = getFuncId(childFunc);
                const funcName = getFuncName(childFunc);
                const hasPagePermission = groupPermissions[funcId] && groupPermissions[funcId].hasPagePermission;

                html += `
                <div class="child-page-section" style="margin:10px;border:1px solid #ccc;border-radius:4px;background:${hasPagePermission ? '#fff' : '#f5f5f5'};${!hasPagePermission ? 'opacity:0.6;' : ''}">
                    <div class="page-header" style="background:#f1f3f4;padding:8px 12px;border-bottom:1px solid #ccc;font-weight:bold;color:#495057;display:flex;justify-content:space-between;align-items:center;font-size:14px;">
                        <span>
                            <i class="fas fa-file-alt"></i> ${funcName}
                            <small class="text-muted" style="margin-left:10px;">(${funcId})</small>
                        </span>
                        <div style="display:flex;gap:5px;">
                            ${isAdmin ? `
                            <button type="button" class="btn btn-sm btn-primary" onclick="selectAllButtons('${funcId}')" style="font-size:10px;padding:1px 6px;" ${!hasPagePermission ? 'disabled' : ''}>
                                <i class="fas fa-check-square"></i> 全勾選
                            </button>
                            <button type="button" class="btn btn-sm btn-secondary" onclick="clearAllButtons('${funcId}')" style="font-size:10px;padding:1px 6px;" ${!hasPagePermission ? 'disabled' : ''}>
                                <i class="fas fa-square"></i> 全取消
                            </button>` : ''}
                        </div>
                    </div>
                    <div class="buttons-container" id="buttons-${funcId}" style="padding:8px;">
                        <div class="no-data"><i class="fas fa-spinner fa-spin"></i> 載入中...</div>
                    </div>
                </div>`;
            });
        }

        html += `</div>`;
    });

    $('#buttonList').html(html);

    // 載入每個頁面的按鈕資料
    parentPages.forEach(parentFunc => {
        loadButtonsForPage(getFuncId(parentFunc));
        (parentChildMap[getFuncId(parentFunc)] || []).forEach(childFunc => {
            loadButtonsForPage(getFuncId(childFunc));
        });
    });
}


⸻

✅ 二、完整替換 loadButtonsForPage()

// 載入指定頁面的按鈕列表（001 可操作、非001唯讀）
function loadButtonsForPage(funcId) {
    const isAdmin = (currentGroupID === '001');
    const hasPagePermission = groupPermissions[funcId] && groupPermissions[funcId].hasPagePermission;

    $.get('@Url.Action("GetButtonsByFuncId", "AP")', {
        func_id: funcId,
        sysID: currentSysID
    }, function (response) {
        let buttonHtml = '';

        if (response.success && Array.isArray(response.data) && response.data.length > 0) {
            response.data.forEach(function (btn) {
                const hasPermission = (groupPermissions[funcId]?.buttons?.[btn.BTNSEQ]) || false;

                if (isAdmin) {
                    // ✅ 管理員：可勾選操作
                    buttonHtml += `
                    <div class="btn-item ${hasPermission ? 'has-permission' : ''}"
                         onclick="toggleButtonPermissionByClick('${funcId}', '${btn.BTNSEQ}')">
                        <div class="permission-content">
                            <input type="checkbox" class="permission-checkbox" ${hasPermission ? 'checked' : ''}>
                            <span class="permission-title">${btn.BTN_NAME}</span>
                            <span class="permission-info">ID: ${btn.BTNID}</span>
                        </div>
                    </div>`;
                } else {
                    // ❌ 非001：唯讀顯示，無checkbox、無onclick
                    buttonHtml += `
                    <div class="btn-item ${hasPermission ? 'has-permission' : ''}" style="pointer-events:none;">
                        <div class="permission-content">
                            <span class="permission-title">${btn.BTN_NAME}</span>
                            <span class="permission-info">ID: ${btn.BTNID}</span>
                        </div>
                    </div>`;
                }
            });

            $(`#buttons-${funcId}`).html(buttonHtml).css({ 'padding': '10px', 'min-height': 'auto' });
        } else {
            // 沒有按鈕
            const noDataHtml = `<div class="no-data-compact" style="padding:8px;text-align:center;color:#6c757d;font-size:12px;">此頁面無按鈕</div>`;
            $(`#buttons-${funcId}`).html(noDataHtml).css({ 'padding': '0', 'min-height': '30px' });
        }
    }).fail(function () {
        const errorHtml = `<div class="no-data-compact" style="padding:8px;text-align:center;color:#dc3545;font-size:12px;">載入失敗</div>`;
        $(`#buttons-${funcId}`).html(errorHtml).css({ 'padding': '0', 'min-height': '30px' });
    });
}


⸻

📘 改完後效果總結

登入身分	按鈕權限操作	勾選功能	全勾選/全取消按鈕	按鈕區塊狀態
001	✅ 可以操作	✅ 可勾選	✅ 顯示可用	正常互動
非001	❌ 唯讀	❌ 不可勾	❌ 按鈕隱藏	只有顯示狀態


⸻

是否要我幫你補上「非001登入 → 按鈕列灰階背景顯示」的CSS（讓整個權限區塊一眼看出是唯讀）？