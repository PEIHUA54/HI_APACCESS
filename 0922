      <!-- 左邊：管理使用者 -->
      <div class="col-md-4">
          <div class="management-section">
              <div class="section-header">
                  <i class="fas fa-users"></i> 管理使用者
                  <button type="button" class="btn btn-primary" onclick="openUserModal()" id="addUserBtn" disabled>
                      <i class="fas fa-plus"></i>
                      新增使用者
                  </button>
                  <button type="button" class="btn btn-info" onclick="openImportModal()" id="importUserBtn" disabled>
                      <i class="fas fa-file-import"></i> 批次匯入使用者
                  </button>
              </div>
              <div id="userList">
                  <div class="no-data">請先選擇群組</div>
              </div>
          </div>
      </div>

<!-- 匯入 Modal -->
<div class="modal fade" id="importModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">批次匯入使用者</h5>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="importForm" enctype="multipart/form-data" method="post">
                    <input type="hidden" name="apg_no" id="importGroupNo" />
                    <input type="file" class="form-control mb-2" name="file" accept=".xls,.xlsx" required />
                    <div class="d-flex justify-content-between">
                        <button type="submit" class="btn btn-primary">匯入</button>
                        <button type="button" class="btn btn-success" onclick="downloadTemplate()">
                            <i class="fas fa-download"></i> 下載範本
                        </button>
                    </div>
                </form>
                <div id="importResult" class="mt-3"></div>
            </div>
        </div>
    </div>
</div>

        // 批次匯入使用者
        function openImportModal() {
            $("#importGroupNo").val($("#groupSelect").val()); // 帶目前選的群組
            $("#importModal").modal("show");
        }

        function downloadTemplate() {
            window.location.href = '@Url.Action("DownloadImportTemplate","AP")';
        }

        $("#importForm").submit(function (e) {
            e.preventDefault();
            var formData = new FormData(this);
            $.ajax({
                url: '@Url.Action("ImportUsers", "AP")',
                type: 'POST',
                data: formData,
                contentType: false,
                processData: false,
                success: function (res) {
                    if (res.success) {
                        $("#importResult").html('<div class="alert alert-success">' + res.message + '</div>');
                        loadUsers();
                    } else {
                        let html = '<div class="alert alert-danger">' + res.message + '</div>';
                        if (res.errors) {
                            html += '<ul>';
                            res.errors.forEach(err => { html += `<li>${err}</li>`; });
                            html += '</ul>';
                        }
                        $("#importResult").html(html);
                    }
                }
            });
        });
