好，謝謝你提供細節 👌
	•	檔案副檔名：批次匯入使用者範本.xlsx → 這是新版 Excel (.xlsx) 格式
	•	第一個工作表名稱：DATA → 你 SQL 寫 ...[DATA$] 是對的

⸻

🔎 問題出在 Extended Properties

你的 SQL 用的是這個：

Extended properties=Excel 12.0

這其實是給舊的 .xls 用的。
對 .xlsx 必須用這個：

Extended properties="Excel 12.0 Xml;HDR=YES";


⸻

✅ 修正後完整 SQL 片段

SET @Query = N'
INSERT INTO #TEMP_IMPORT (EMP_NO)
SELECT CAST(t.[員工編號] AS VARCHAR(20))
FROM OpenDataSource(
    ''Microsoft.ACE.OLEDB.12.0'',
    ''Data Source=' + REPLACE(@filePath, '''', '''''') + ';
    Extended properties="Excel 12.0 Xml;HDR=YES"''
)...[DATA$] AS t
WHERE t.[員工編號] IS NOT NULL AND t.[員工編號] <> ''''
';


⸻

🚀 這樣改的效果
	1.	Xml → 對應 .xlsx 格式，不會再抓不到。
	2.	HDR=YES → 第一列會當欄位名稱，你才能正確用 t.[員工編號]。

⸻

再提醒一次 ⚠️
	•	如果有一天你要支援 .xls 舊格式，就要用：

Extended properties="Excel 8.0;HDR=YES";


	•	現在你的範本是 .xlsx，所以必須用 Excel 12.0 Xml;HDR=YES。

⸻

要不要我幫你把 BuildUserImportSql() 的 完整修正版 整理給你？這樣你就可以直接換掉，不會再 0 筆。